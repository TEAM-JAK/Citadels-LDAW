{"version":3,"sources":["store/store.js","game/config/client.js","services/LobbyService.js","game/config/index.js","components/firebase/FirebaseContext.react.js","components/create_game/CreateGameDialog.react.js","components/create_game/CreateGameButton.react.js","hooks/useBoolean.js","components/shared/FlexLayout.react.js","components/home/RoomsListItem.react.js","components/home/RoomsList.react.js","components/home/Home.react.js","components/lobby/LobbySetup.react.js","game/Cards.js","game/Moves.js","game/Logic.js","game/CitadelsGame.js","components/game/Utiliy.js","components/bgioComponents/logo.js","components/bgioComponents/ui-context.js","components/bgioComponents/card.js","components/game/Dialogs.react.js","components/game/PlayerCard.react.js","components/game/Board.react.js","components/game/GameApp.react.js","components/lobby/Lobby.react.js","utils/Firebase.js","components/authentication/SignInForm.react.js","constants/routes.js","components/authentication/SignUpForm.react.js","components/authentication/Authentication.react.js","components/shared/AuthRenderer.react.js","components/shared/NoAuthRenderer.react.js","App.react.js","index.js","store/index.js"],"names":["initState","store","rooms","setRooms","action","state","payload","loadRooms","thunk","actions","a","injections","lobbyApi","getRooms","roomID","setRoomID","createGameRoom","createRoom","roomMetadata","setRoomMetadata","loadRoomMetadata","getRoomMetadata","metadata","loadingJoinRoom","setLoadingJoinRoom","activeRoomPlayer","setActiveRoomPlayer","localStorage","setItem","JSON","stringify","joinRoom","getStoreState","playerCredentials","credential","playerID","reset","window","location","origin","BGIO_SERVER_URL","protocol","hostname","LobbyService","this","api","ky","create","prefixUrl","numPlayers","setupData","players","Number","parseInt","post","json","data","matchID","playerName","get","fetch","then","res","matches","FirebaseContext","React","createContext","useStyles","makeStyles","paper","minWidth","form","display","flexDirection","field","marginBottom","CreateGameDialog","props","classes","useState","roomName","numberOfPlayers","fields","setFields","fieldErrors","setFieldErrors","Dialog","open","onClose","aria-labelledby","DialogTitle","id","DialogContent","className","TextField","fullWidth","label","value","onChange","e","target","error","helperText","FormControl","InputLabel","Select","labelId","MenuItem","FormHelperText","DialogActions","Button","onClick","color","event","errors","validator","isEmpty","noNullErrors","Object","keys","reduce","acc","current","length","onSubmit","CreateGameButton","initialState","setValue","set","toggle","useCallback","setTrue","setFalse","useBoolean","variant","root","directionHorizontal","directionHorizontalReverse","directionVertical","directionVerticalReverse","justifyStart","justifyContent","justifyEnd","justifyCenter","justifyBetween","justifyAround","justifyEvenly","alignStart","alignItems","alignEnd","alignCenter","alignStretch","alignBaseline","wrap","flexWrap","wrapReverse","FlexLayout","align","children","direction","justify","clsx","padding","backgroundColor","borderRadius","borderStyle","borderWidth","borderColor","details","marginRight","width","RoomsListItem","room","onJoin","Typography","gutterBottom","listStyle","margin","RoomsList","map","key","paddingBottom","paddingTop","paddingRight","paddingLeft","creation","Home","useStoreState","s","useStoreActions","firebase","useContext","userProfile","setUserProfile","useEffect","fetchUserProfile","profile","fetchProfile","firestore","collection","onSnapshot","snapshot","result","forEach","doc","push","to","username","height","LobbySetup","startGame","useParams","gameRoomFull","filter","p","name","firstWithoutName","find","emptySeatID","index","setTimeout","player","districtCardInDeck","quantity","cost","type","imageURL","cards","front","back","getCurrentCharacter","G","ctx","console","log","currentPlayer","chosenCharacter","order","EndTurn","powerUsed","districtBuiltOnTurn","deckOfCharacters","splice","events","endStage","endTurn","addExtraCoin","typeOfDistrict","addedGold","goldDistrictCount","builtCity","city","getExtraCoins","pileOfCoins","coins","UseCharacterPower","toMurder","murderedCharacter","assasinPower","toSteal","muggedCharacter","muggedFromPlayer","muggedToCharacter","thiefPower","isOptionA","changeHandsWith","resultSecret","secret","currentPlayerHand","hand","magicianPowerA","changeMyHandIndx","sort","b","numOfCards","x","deckOfDistricts","i","shift","magicianPowerB","isKing","indx","Shuffle","array","j","Math","floor","random","GameSetUp","deck","CreateDeckOfDistricts","backSrc","CreateDeckOfCharacters","handCount","pop","faceDownCharacterCards","faceUpCharacterCards","playerWithCrown","finishedFirst","CitadelsGame","setup","phases","drawPhase","turn","first","next","playOrderPos","playOrder","playerOrder","Array","doubleTurn","concat","element","GetPlayerOrderDrawPhase","moveLimit","onBegin","randomNumber","SetDrawPhase","moves","ChooseCharacter","indx1","indx2","endIf","IsDrawPhaseOver","start","playPhase","activePlayers","stage","muggedPlayer","characterOrder","some","findPlayerWithCharacter","BeginPlayTurn","dict","GetPlayerOrderPlayPhase","stages","takeActionStage","TakeCoin","addCards","TakeDistrictCard","choseFirstCard","second","buildStage","BuildDistrict","handIndex","canBuild","setStage","SkipOrEndStage","extraStage","WarlordPower","destroy","destroyedCity","builtCityHandIndx","newPlayers","SetPlayPhase","IsPlayPhaseOver","onEnd","CleanPlayPhase","minPlayers","maxPlayers","gameIsOver","phase","IsGameOver","scores","baseScore","extra","allTypes","hasYellow","hasBlue","hasGreen","hasRed","hasPurple","GameOver","disableUndo","HashOfString","string","hash","charCodeAt","FindPlayerWithCharacter","CanBuild","Logo","xmlns","viewBox","d","fill","UIContext","CardImpl","dragComponentRef","createRef","isOverAccepted","classNames","cardStyle","inDeck","position","zIndex","deckPosition","dragZone","isActive","join","style","opacity","pointerEvents","isFaceUp","GetDraggable","for","ref","isOverAcceptedCallback","y","currentlyHoveredDroppableId","content","cursor","boxShadow","left","top","GetDragComponent","o","Component","defaultProps","Card","Consumer","context","ChooseCharacterDialog","dialogOpen","setDialogOpen","value1","value2","setChosenCharacter","uicontext","cardsNotAvailable","cardsToChoose","cardElement","image","src","alt","canHover","disableBackdropClick","disableEscapeKeyDown","ShowPlayers","setPayload","ShowHand","handCards","selectedCards","setSelectedCards","containIndx","findIndex","slice","handleClick","UseCharacterPowerDialog","characterNumber","useCharacterBtn","setUseCharacterBtn","checkBox","setCheckBox","dialogContent","Checkbox","checked","disabled","TakeActionDialog","setEndStageBtn","setBuildDistrictBtn","takeActionBtn","setTakeActionBtn","setAction","takeActionOptions","BuildDistricDialog","buildDistrictBtn","setDestroyBtn","districtToBuild","setDistrictToBuild","buildOptions","handleClose","PlayerHand","setPayLoad","DestroyDistricDialog","hands","bishopPlayerID","destroyBtn","payLoad","setPlayerID","menuItems","distroyDialogContent","PlayerCard","citiesBuilt","character","flex","cardsInHand","Tooltip","title","placement","PlayPhaseUI","endStageBtn","OtherPlayerTurn","situation","activePlayer","Board","playerCards","districtsInMyHand","citiesInMyHand","bottom","transform","gameover","GameApp","Client","game","board","multiplayer","SocketIO","server","debug","LobbyPlay","String","credentials","Lobby","isGameRunning","setGameRunning","config","apiKey","process","authDomain","databaseURL","projectId","storageBucket","messagingSenderId","appId","measurementId","AUTH_ERRORS","Firebase","createUserWithEmailAndPassword","email","password","auth","signInWithEmailAndPassword","signOut","currentUser","uid","userData","updateProfile","user","update","catch","app","initializeApp","facebookProvider","FacebookAuthProvider","marginTop","submit","submitProgress","marginLeft","button","minHeight","socialContainer","social","border","SignInForm","history","useHistory","showPassword","setShowPassword","loading","setLoading","signInWithPopup","displayName","replace","icon","faFacebookF","noValidate","preventDefault","isEmail","err","code","method","htmlFor","OutlinedInput","endAdornment","InputAdornment","IconButton","aria-label","edge","labelWidth","CircularProgress","size","SignUpForm","showConfirmationPassword","setShowConfirmationPassword","confirmationPassword","isLength","min","equals","background","card","panel","rightPanel","Authentication","Paper","AuthRenderer","fallback","authenticated","setState","listener","onAuthStateChanged","logged","NoAuthRenderer","App","exact","path","theme","createMuiTheme","typography","fontFamily","savedPlayer","getItem","createStore","initializeStore","parse","ReactDOM","render","Provider","document","getElementById"],"mappings":"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A,SACA,EACA,EACA,yKAGJmE,EAAKpF,KAAL,MAAAoF,EAAI,aACCnE,GACD,EACA,SACA,EACA,EACA,yKAGJmE,EAAKpF,KAAL,MAAAoF,EAAI,aACCnE,GACD,EACA,YACA,EACA,EACA,0KAGJmE,EAAKpF,KAAL,MAAAoF,EAAI,aACCnE,GACD,EACA,aACA,EACA,EACA,wKAGJmE,EAAKpF,KAAL,MAAAoF,EAAI,aACCnE,GACD,EACA,UACA,EACA,EACA,wKAGJmE,EAAKpF,KAAL,MAAAoF,EAAI,aACCnE,GACD,EACA,UACA,EACA,EACA,wKAGJmE,EAAKpF,KAAL,MAAAoF,EAAI,aACCnE,GACD,EACA,UACA,EACA,EACA,2KAGJmE,EAAKpF,KAAL,MAAAoF,EAAI,aACCnE,GACD,EACA,WACA,EACA,EACA,4KAGJmE,EAAKpF,KAAL,MAAAoF,EAAI,aACCnE,GACD,EACA,gBACA,EACA,EACA,2KAcGmE,EG3FeC,GACtBR,GAAQN,GACR,IAAInC,EH4FC,WACL,IAAMkD,EACJ,qJAmIF,MAlIa,CACX,CACEtD,MAAO,EACPtB,KAAM,UACNa,MACE,uKACFC,KAAM8D,GAER,CACEtD,MAAO,EACPtB,KAAM,QACNa,MACE,sKACFC,KAAM8D,GAER,CACEtD,MAAO,EACPtB,KAAM,WACNa,MACE,oKACFC,KAAM8D,GAER,CACEtD,MAAO,EACPtB,KAAM,OACNa,MACE,mKACFC,KAAM8D,GAER,CACEtD,MAAO,EACPtB,KAAM,SACNa,MACE,sKACFC,KAAM8D,GAER,CACEtD,MAAO,EACPtB,KAAM,WACNa,MACE,wKACFC,KAAM8D,GAER,CACEtD,MAAO,EACPtB,KAAM,YACNa,MACE,0KACFC,KAAM8D,GAER,CACEtD,MAAO,EACPtB,KAAM,UACNa,MACE,wKACFC,KAAM8D,IGtJaC,GACvBV,GAAQzC,GASR,IARA,IAMI0B,EAAS,GACTxN,EAAU,GACLkO,EAAI,EAAGA,EAAI7C,EAAIvL,WAAYoO,IAAK,CACvClO,EAAQkO,GA9BH,CACLvB,MAAO,EACPJ,UAAW,GACX2C,UAAW,EACXzD,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","file":"static/js/main.67ed0860.chunk.js","sourcesContent":["import {action, thunk} from 'easy-peasy';\n\n// export interface ActiveRoomPlayer {\n//   playerID: number;\n//   credential: string;\n// }\n\n// export interface StoreModel {\n//   rooms: RoomMetadata[];\n//   roomID: string | null;\n//   setRoomID: Action<StoreModel, string>;\n//   createGameRoom: Thunk<StoreModel, number, StoreInjections>;\n//   roomMetadata: RoomMetadata | null;\n//   setRoomMetadata: Action<StoreModel, RoomMetadata>;\n//   loadRoomMetadata: Thunk<StoreModel, string, StoreInjections>;\n//   activeRoomPlayer: ActiveRoomPlayer | null;\n//   setActiveRoomPlayer: Action<StoreModel, ActiveRoomPlayer>;\n//   joinRoom: Thunk<StoreModel, JoinRoomParams, StoreInjections>;\n//   reset: Action;\n// }\n\n// 'player' refers to users player in the game room\nexport const PLAYER_STORAGE_KEY = 'citadels_player';\n\nexport let initState = {};\nexport const setInitState = (state) => {\n  if (state) initState = state;\n};\n\nexport const store = {\n  rooms: [],\n  setRooms: action((state, payload) => {\n    state.rooms = payload;\n  }),\n  loadRooms: thunk(async (actions, payload, {injections}) => {\n    const rooms = await injections.lobbyApi.getRooms();\n    actions.setRooms(rooms);\n  }),\n\n  roomID: null,\n  setRoomID: action((state, payload) => {\n    state.roomID = payload;\n  }),\n  createGameRoom: thunk(async (actions, payload, {injections}) => {\n    const roomID = await injections.lobbyApi.createRoom(payload);\n    actions.setRoomID(roomID);\n  }),\n\n  roomMetadata: null,\n  setRoomMetadata: action((state, payload) => {\n    state.roomMetadata = payload;\n  }),\n  loadRoomMetadata: thunk(async (actions, payload, {injections}) => {\n    const metadata = await injections.lobbyApi.getRoomMetadata(payload);\n    actions.setRoomMetadata(metadata);\n  }),\n\n  loadingJoinRoom: false,\n  setLoadingJoinRoom: action((state, payload) => {\n    state.loadingJoinRoom = payload;\n  }),\n  activeRoomPlayer: null,\n  setActiveRoomPlayer: action((state, payload) => {\n    localStorage.setItem(PLAYER_STORAGE_KEY, JSON.stringify(payload));\n    state.activeRoomPlayer = payload;\n  }),\n  joinRoom: thunk(async (actions, payload, {injections, getStoreState}) => {\n    if (!getStoreState().loadingJoinRoom) {\n      actions.setLoadingJoinRoom(true);\n      const playerCredentials = await injections.lobbyApi.joinRoom(payload);\n      actions.setLoadingJoinRoom(false);\n      actions.setActiveRoomPlayer({\n        credential: playerCredentials,\n        playerID: payload.playerID,\n      });\n    }\n  }),\n\n  reset: action(() => initState),\n};\n","import {isProduction, DEFAULT_PORT} from '.';\n\nconst {origin, protocol, hostname} = window.location;\nexport const BGIO_SERVER_URL = isProduction\n  ? origin\n  : `${protocol}//${hostname}:${DEFAULT_PORT}`;\n","import ky from 'ky';\nimport {GAME_NAME} from 'game/config';\nimport {BGIO_SERVER_URL} from 'game/config/client';\n\n// export interface Player {\n//   id: number;\n//   name?: string;\n// }\n\n// export interface RoomMetadata {\n//   players: Player[];\n//   matchID: string;\n//   setupData: object;\n//   unlisted: bool;\n// }\n\n// export interface ActiveRoomPlayer {\n//   playerID: number;\n//   credential: string;\n// }\n\n// export interface JoinRoomParams {\n//   roomID: string;\n//   playerID: number;\n//   playerName: string;\n// }\n\nexport default class LobbyService {\n  constructor() {\n    this.api = ky.create({prefixUrl: `${BGIO_SERVER_URL}/games/${GAME_NAME}`});\n  }\n\n  async createRoom({numPlayers, setupData}) {\n    const players = Number.parseInt(numPlayers, 10);\n    const data = await this.api\n      .post('create', {json: {numPlayers: players, setupData}})\n      .json();\n    return data.matchID;\n  }\n\n  async joinRoom({roomID, playerID, playerName}) {\n    const {playerCredentials} = await this.api\n      .post(roomID + '/join', {\n        json: {playerID, playerName},\n      })\n      .json();\n\n    return playerCredentials;\n  }\n\n  getRoomMetadata(roomID) {\n    return this.api.get(roomID).json();\n  }\n\n  async getRooms() {\n    const data = await fetch(`${BGIO_SERVER_URL}/games/${GAME_NAME}`).then((res) =>\n      res.json(),\n    );\n    return data.matches;\n  }\n}\n","export const GAME_NAME = 'citadels';\nexport const DEFAULT_PORT = '3002';\nexport const isProduction = process.env.NODE_ENV === 'production';\n","import React from 'react';\n\nconst FirebaseContext = React.createContext(null);\n\nexport default FirebaseContext;\n","import React from 'react';\nimport Button from '@material-ui/core/Button';\nimport TextField from '@material-ui/core/TextField';\nimport Dialog from '@material-ui/core/Dialog';\nimport DialogActions from '@material-ui/core/DialogActions';\nimport DialogContent from '@material-ui/core/DialogContent';\nimport DialogTitle from '@material-ui/core/DialogTitle';\nimport {useState} from 'react';\nimport MenuItem from '@material-ui/core/MenuItem';\nimport InputLabel from '@material-ui/core/InputLabel';\nimport FormHelperText from '@material-ui/core/FormHelperText';\nimport FormControl from '@material-ui/core/FormControl';\nimport Select from '@material-ui/core/Select';\nimport Checkbox from '@material-ui/core/Checkbox';\nimport validator from 'validator';\nimport {makeStyles} from '@material-ui/core/styles';\n\nconst useStyles = makeStyles({\n  paper: {\n    minWidth: 768,\n  },\n  form: {\n    display: 'flex',\n    flexDirection: 'column',\n  },\n  field: {\n    marginBottom: 16,\n  },\n});\n\nfunction CreateGameDialog(props) {\n  const classes = useStyles();\n  const [isPrivateGame, setIsPrivateGame] = useState(false);\n  const [fields, setFields] = useState({\n    roomName: '',\n    numberOfPlayers: '4',\n  });\n  const [fieldErrors, setFieldErrors] = useState({\n    roomName: null,\n    numberOfPlayers: null,\n  });\n\n  const handleFormOnSubmit = (event) => {\n    let errors = {\n      roomName: null,\n      numberOfPlayers: null,\n    };\n\n    if (validator.isEmpty(fields.roomName)) {\n      errors = {...errors, roomName: 'Must not be empty'};\n    }\n\n    if (validator.isEmpty(fields.numberOfPlayers)) {\n      errors = {...errors, numberOfPlayers: 'Must not be empty'};\n    }\n\n    setFieldErrors(errors);\n\n    const noNullErrors = Object.keys(errors).reduce((acc, current) => {\n      if (errors[current] == null) {\n        return acc;\n      }\n      acc[current] = errors[current];\n      return acc;\n    }, {});\n\n    if (Object.keys(noNullErrors).length !== 0) {\n      return;\n    }\n\n    props.onSubmit({\n      setupData: {roomName: fields.roomName},\n      numPlayers: fields.numberOfPlayers,\n    });\n  };\n\n  return (\n    <Dialog\n      classes={{paper: classes.paper}}\n      open={props.open}\n      onClose={props.onClose}\n      aria-labelledby=\"create-game-dialog\"\n    >\n      <DialogTitle id=\"create-game-dialog\">Create a Game</DialogTitle>\n      <DialogContent>\n        <div className={classes.form}>\n          <TextField\n            fullWidth\n            className={classes.field}\n            label=\"Room Name\"\n            value={fields.roomName}\n            onChange={(e) => setFields({...fields, roomName: e.target.value})}\n            error={fieldErrors.roomName != null}\n            helperText={fieldErrors.roomName}\n          />\n          <FormControl\n            className={classes.field}\n            error={fieldErrors.numberOfPlayers != null}\n          >\n            <InputLabel id=\"create-game-number-players-select-label\">\n              Number Of Players\n            </InputLabel>\n            <Select\n              labelId=\"create-game-number-players-select-label\"\n              id=\"create-game-number-players-select\"\n              value={fields.numberOfPlayers}\n              onChange={(e) => setFields({...fields, numberOfPlayers: e.target.value})}\n            >\n              <MenuItem value=\"4\">\n                <em>4</em>\n              </MenuItem>\n              <MenuItem value=\"2\">2</MenuItem>\n              <MenuItem value=\"3\">3</MenuItem>\n              <MenuItem value=\"5\">5</MenuItem>\n              <MenuItem value=\"6\">6</MenuItem>\n              <MenuItem value=\"7\">7</MenuItem>\n            </Select>\n            {fieldErrors.numberOfPlayers != null ? (\n              <FormHelperText>{fieldErrors.numberOfPlayers}</FormHelperText>\n            ) : null}\n          </FormControl>\n        </div>\n      </DialogContent>\n      <DialogActions>\n        <Button onClick={props.onClose} color=\"primary\">\n          Cancel\n        </Button>\n        <Button onClick={handleFormOnSubmit} color=\"primary\">\n          Create Game\n        </Button>\n      </DialogActions>\n    </Dialog>\n  );\n}\n\nexport default CreateGameDialog;\n","import React, {useState} from 'react';\nimport Button from '@material-ui/core/Button';\nimport CreateGameDialog from 'components/create_game/CreateGameDialog.react';\nimport useBoolean from 'hooks/useBoolean';\n\nexport default function CreateGameButton(props) {\n  const {value: open, setTrue, setFalse} = useBoolean(false);\n\n  function onSubmit(data) {\n    setFalse();\n    props.onSubmit(data);\n  }\n\n  return (\n    <>\n      <Button variant=\"contained\" color=\"primary\" onClick={() => setTrue()}>\n        Create Game\n      </Button>\n      <CreateGameDialog open={open} onClose={() => setFalse()} onSubmit={onSubmit} />\n    </>\n  );\n}\n","import {useCallback, useState} from 'react';\n\nexport default function useBoolean(initialState) {\n  const [value, setValue] = useState(initialState);\n\n  return {\n    value,\n    set: setValue,\n    toggle: useCallback(() => setValue(!value), []),\n    setTrue: useCallback(() => setValue(true), []),\n    setFalse: useCallback(() => setValue(false), []),\n  };\n}\n","// @flow strict\n\nimport React from 'react';\nimport {makeStyles} from '@material-ui/core/styles';\nimport clsx from 'clsx';\n\n// type Align = 'start' | 'end' | 'center' | 'baseline' | 'stretch';\n// type Direction = 'horizontal' | 'horizontal-reverse' | 'vertical' | 'vertical-reverse';\n// type Justify = 'start' | 'end' | 'center' | 'between' | 'around' | 'evenly';\n// type Wrap = 'nowrap' | 'wrap' | 'wrap-reverse';\n\nconst useStyles = makeStyles({\n  root: {\n    display: 'flex',\n  },\n  directionHorizontal: {\n    flexDirection: 'row',\n  },\n  directionHorizontalReverse: {\n    flexDirection: 'row-reverse',\n  },\n  directionVertical: {\n    flexDirection: 'column',\n  },\n  directionVerticalReverse: {\n    flexDirection: 'column-reverse',\n  },\n  justifyStart: {\n    justifyContent: 'flex-start',\n  },\n  justifyEnd: {\n    justifyContent: 'flex-end',\n  },\n  justifyCenter: {\n    justifyContent: 'center',\n  },\n  justifyBetween: {\n    justifyContent: 'space-between',\n  },\n  justifyAround: {\n    justifyContent: 'space-around',\n  },\n  justifyEvenly: {\n    justifyContent: 'space-evenly',\n  },\n  alignStart: {\n    alignItems: 'flex-start',\n  },\n  alignEnd: {\n    alignItems: 'flex-end',\n  },\n  alignCenter: {\n    alignItems: 'center',\n  },\n  alignStretch: {\n    alignItems: 'stretch',\n  },\n  alignBaseline: {\n    alignItems: 'baseline',\n  },\n  wrap: {\n    flexWrap: 'wrap',\n  },\n  wrapReverse: {\n    flexWrap: 'wrap-reverse',\n  },\n});\n\n// type Props = $ReadOnly<{\n//   align?: Align,\n//   children?: ?Node,\n//   className?: ?string,\n//   direction?: Direction,\n//   justify?: Justify,\n//   wrap?: Wrap,\n// }>;\n\nexport default function FlexLayout({\n  align = 'start',\n  children,\n  className,\n  direction = 'horizontal',\n  justify = 'start',\n  wrap = 'nowrap',\n}) {\n  const classes = useStyles();\n  return (\n    <div\n      className={clsx(className, classes.root, {\n        [classes.directionHorizontal]: direction === 'horizontal',\n        [classes.directionHorizontalReverse]: direction === 'horizontal-reverse',\n        [classes.directionVertical]: direction === 'vertical',\n        [classes.directionVerticalReverse]: direction === 'vertical-reverse',\n        [classes.justifyStart]: justify === 'start',\n        [classes.justifyEnd]: justify === 'end',\n        [classes.justifyCenter]: justify === 'center',\n        [classes.justifyBetween]: justify === 'between',\n        [classes.justifyAround]: justify === 'around',\n        [classes.justifyEvenly]: justify === 'evenly',\n        [classes.alignStart]: align === 'start',\n        [classes.alignEnd]: align === 'end',\n        [classes.alignCenter]: align === 'center',\n        [classes.alignStretch]: align === 'stretch',\n        [classes.alignBaseline]: align === 'baseline',\n        // flex-wrap: nowrap is the default\n        [classes.wrap]: wrap === 'wrap',\n        [classes.wrapReverse]: wrap === 'wrap-reverse',\n      })}\n    >\n      {children}\n    </div>\n  );\n}\n","import React from 'react';\nimport {makeStyles} from '@material-ui/core/styles';\nimport FlexLayout from 'components/shared/FlexLayout.react';\nimport Typography from '@material-ui/core/Typography';\nimport Button from '@material-ui/core/Button';\n\nconst useStyles = makeStyles({\n  root: {\n    padding: 16,\n    backgroundColor: '#fffffd',\n    borderRadius: 8,\n    borderStyle: 'solid',\n    borderWidth: 4,\n    borderColor: '#f2f2f2',\n  },\n  details: {\n    marginRight: 24,\n    width: 256,\n  },\n});\n\nexport default function RoomsListItem({room, onJoin}) {\n  const classes = useStyles();\n  return (\n    <FlexLayout align=\"center\" className={classes.root}>\n      <FlexLayout direction=\"vertical\" className={classes.details}>\n        <Typography gutterBottom>{`ID: ${room.matchID}`}</Typography>\n        <Typography>{`Name: ${room.setupData.roomName}`}</Typography>\n      </FlexLayout>\n      <Button variant=\"contained\" color=\"primary\" onClick={() => onJoin(room.matchID)}>\n        Join\n      </Button>\n    </FlexLayout>\n  );\n}\n","import React from 'react';\nimport {makeStyles} from '@material-ui/core/styles';\nimport RoomsListItem from 'components/home/RoomsListItem.react';\n\nconst useStyles = makeStyles({\n  root: {\n    listStyle: 'none',\n    padding: 0,\n    margin: 0,\n  },\n});\n\nexport default function RoomsList(props) {\n  const classes = useStyles();\n  return (\n    <ul className={classes.root}>\n      {props.rooms.map((room) => (\n        <li key={room.matchID}>\n          <RoomsListItem room={room} onJoin={props.onJoin} />\n        </li>\n      ))}\n    </ul>\n  );\n}\n","import React, {useContext, useState, useEffect, useCallback} from 'react';\nimport {Redirect} from 'react-router-dom';\nimport {useStoreActions, useStoreState} from 'easy-peasy';\nimport Typography from '@material-ui/core/Typography';\nimport {makeStyles} from '@material-ui/core/styles';\nimport FirebaseContext from 'components/firebase/FirebaseContext.react';\nimport CreateGameButton from 'components/create_game/CreateGameButton.react';\nimport RoomsList from 'components/home/RoomsList.react';\n\nconst useStyles = makeStyles({\n  root: {\n    paddingBottom: 24,\n    display: 'flex',\n    paddingTop: 16,\n    flexDirection: 'column',\n    paddingRight: 24,\n    paddingLeft: 24,\n  },\n  creation: {\n    display: 'flex',\n    flexDirection: 'column',\n    alignItems: 'flex-start',\n    marginBottom: 24,\n  },\n});\n\nexport default function Home() {\n  const classes = useStyles();\n  const rooms = useStoreState((s) => s.rooms);\n  const createGameRoom = useStoreActions((s) => s.createGameRoom);\n  const setRooms = useStoreActions((s) => s.setRooms);\n  const loadRooms = useStoreActions((s) => s.loadRooms);\n  const setRoomID = useStoreActions((s) => s.setRoomID);\n  const roomID = useStoreState((s) => s.roomID);\n  const firebase = useContext(FirebaseContext);\n  const [userProfile, setUserProfile] = useState(null);\n\n  const onJoin = useCallback(\n    (matchID) => {\n      setRoomID(matchID);\n    },\n    [setRoomID],\n  );\n\n  useEffect(() => {\n    async function fetchProfile() {\n      const profile = await firebase.fetchUserProfile();\n      setUserProfile(profile);\n    }\n    fetchProfile();\n  }, [setUserProfile, firebase]);\n\n  useEffect(() => {\n    // const intervalID = setInterval(() => {\n    //   loadRooms();\n    // }, 500);\n\n    // return () => clearInterval(intervalID);\n    firebase.firestore.collection('bgio_metadata').onSnapshot((snapshot) => {\n      const result = [];\n      snapshot.forEach((doc) => {\n        result.push({...doc.data(), matchID: doc.id});\n      });\n      setRooms(result);\n    });\n  }, [firebase, setRooms]);\n\n  if (roomID != null) return <Redirect to={`/rooms/${roomID}`} />;\n\n  return (\n    <main className={classes.root}>\n      <div className={classes.creation}>\n        <Typography variant=\"h4\" gutterBottom>\n          {`Welcome${userProfile ? ` ${userProfile.username}` : ''}!`}\n        </Typography>\n        <CreateGameButton onSubmit={createGameRoom} />\n      </div>\n      <div>\n        <RoomsList rooms={rooms} onJoin={onJoin} />\n      </div>\n    </main>\n  );\n}\n","import React, {useContext, useState, useEffect, useCallback} from 'react';\nimport {Redirect} from 'react-router-dom';\nimport {useStoreActions, useStoreState} from 'easy-peasy';\nimport Typography from '@material-ui/core/Typography';\nimport {makeStyles} from '@material-ui/core/styles';\nimport FirebaseContext from 'components/firebase/FirebaseContext.react';\nimport CreateGameButton from 'components/create_game/CreateGameButton.react';\nimport RoomsList from 'components/home/RoomsList.react';\nimport {useParams} from 'react-router-dom';\nimport FlexLayout from 'components/shared/FlexLayout.react';\n\nconst useStyles = makeStyles({\n  root: {\n    width: '100vw',\n    height: '100vh',\n    display: 'flex',\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  creation: {\n    display: 'flex',\n    flexDirection: 'column',\n    alignItems: 'flex-start',\n    marginBottom: 24,\n  },\n});\n\nexport default function LobbySetup({startGame}) {\n  const {id} = useParams();\n  const classes = useStyles();\n  const setRoomMetadata = useStoreActions((s) => s.setRoomMetadata);\n  const roomMetadata = useStoreState((s) => s.roomMetadata);\n  const firebase = useContext(FirebaseContext);\n  const [userProfile, setUserProfile] = useState(null);\n  const activeRoomPlayer = useStoreState((s) => s.activeRoomPlayer);\n  const joinRoom = useStoreActions((s) => s.joinRoom);\n\n  const gameRoomFull =\n    roomMetadata != null\n      ? roomMetadata.players.filter((p) => !p.name).length === 0\n      : false;\n\n  useEffect(() => {\n    async function fetchProfile() {\n      const profile = await firebase.fetchUserProfile();\n      setUserProfile(profile);\n    }\n    fetchProfile();\n  }, [setUserProfile, firebase]);\n\n  useEffect(() => {\n    if (userProfile != null && userProfile.username != null && roomMetadata != null) {\n      // find first empty seat ID\n      const firstWithoutName = roomMetadata.players.find((p) => !p.name);\n      const emptySeatID = firstWithoutName ? firstWithoutName.id : null;\n      const alreadyJoined =\n        activeRoomPlayer == null\n          ? false\n          : roomMetadata.players.find((p) => {\n              return (\n                p.id === activeRoomPlayer.playerID && p.name === userProfile.username\n              );\n            }) != null;\n      if (!alreadyJoined && emptySeatID != null && id) {\n        joinRoom({\n          playerID: emptySeatID,\n          playerName: userProfile.username,\n          roomID: id,\n        });\n      }\n    }\n  }, [roomMetadata, userProfile]);\n\n  useEffect(() => {\n    if (id) {\n      firebase.firestore\n        .collection('bgio_metadata')\n        .doc(id)\n        .onSnapshot((doc) => {\n          const data = {...doc.data()};\n          data.players = Object.keys(data.players).map((index) => data.players[index]);\n          setRoomMetadata({...data, matchID: doc.id});\n        });\n    }\n  }, [firebase, setRoomMetadata, id]);\n\n  useEffect(() => {\n    if (gameRoomFull) {\n      setTimeout(() => startGame(), 2000);\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [gameRoomFull]);\n\n  return (\n    <main className={classes.root}>\n      <FlexLayout direction=\"vertical\">\n        <div>\n          {roomMetadata != null ? (\n            <ul>\n              {roomMetadata.players.map((player) => (\n                <li key={player.id}>\n                  {player.name != null ? (\n                    <Typography>{`Player ${player.name} joined!`}</Typography>\n                  ) : (\n                    <Typography>Waiting for player to join</Typography>\n                  )}\n                </li>\n              ))}\n            </ul>\n          ) : (\n            <Typography>Loading...</Typography>\n          )}\n        </div>\n        <div>\n          {gameRoomFull ? (\n            <Typography>Starting Game...</Typography>\n          ) : (\n            <Typography>Game will start when all players join!</Typography>\n          )}\n        </div>\n      </FlexLayout>\n    </main>\n  );\n}\n","// TODO: implement\n// createDeckOfDistricts() -> returns {array of district cards}, set up random purple cards\n// createDeckOfCharacters() -> returns {array of character cards}\n//\n// districtCard {\n//   cost: Int,\n//   type: Int, // 0: Novel|Yellow, 1:Religious|Blue, 2: Trade|Green, 3: Military|Red, 4: Special|Purple\n//   // specialPower: funct // implement after if ther is time\n// }\n//\n// characterCard {\n//   order : Int,\n//   name : String,\n//   power : funct\n// }\n\nfunction districtCardInDeck(quantity, name, cost, type, imageURL) {\n  let cards = [];\n  const backSrc =\n    'https://firebasestorage.googleapis.com/v0/b/citadels-ldaw.appspot.com/o/cards%2Fback_orange.jpg?alt=media&token=4a5738af-f9f7-43e4-a3cf-62541b32f283';\n  for (let index = 0; index < quantity; index++) {\n    cards.push({name: name, type: type, cost: cost, front: imageURL, back: backSrc});\n  }\n  return cards;\n}\n\nexport function CreateDeckOfDistricts() {\n  const deck = [];\n  deck.push(\n    ...districtCardInDeck(\n      3,\n      'Templo',\n      1,\n      1,\n      'https://firebasestorage.googleapis.com/v0/b/citadels-ldaw.appspot.com/o/cards%2Fdistricts%2Fblue%2Ftemplo.jpg?alt=media&token=2942172a-29de-4fcf-8ec1-ef95ef919c8d',\n    ),\n  );\n  deck.push(\n    ...districtCardInDeck(\n      3,\n      'Iglesia',\n      2,\n      1,\n      'https://firebasestorage.googleapis.com/v0/b/citadels-ldaw.appspot.com/o/cards%2Fdistricts%2Fblue%2Figlesia.jpg?alt=media&token=008b54c2-55a9-4088-b997-f8310a0a1d76',\n    ),\n  );\n  deck.push(\n    ...districtCardInDeck(\n      3,\n      'Monasterio',\n      3,\n      1,\n      'https://firebasestorage.googleapis.com/v0/b/citadels-ldaw.appspot.com/o/cards%2Fdistricts%2Fblue%2Fmonasterio.jpg?alt=media&token=3355cf48-1f74-4bac-89e3-e055df55823c',\n    ),\n  );\n  deck.push(\n    ...districtCardInDeck(\n      2,\n      'Catedral',\n      5,\n      1,\n      'https://firebasestorage.googleapis.com/v0/b/citadels-ldaw.appspot.com/o/cards%2Fdistricts%2Fblue%2Fcatedral.jpg?alt=media&token=e21f93a0-146d-4aa8-a31e-86407ce0f2b6',\n    ),\n  );\n  deck.push(\n    ...districtCardInDeck(\n      2,\n      'Ayuntamiento',\n      5,\n      2,\n      'https://firebasestorage.googleapis.com/v0/b/citadels-ldaw.appspot.com/o/cards%2Fdistricts%2Fgreen%2Fayuntamiento.jpg?alt=media&token=68d71e9a-0858-4f04-9267-878a528131d6',\n    ),\n  );\n  deck.push(\n    ...districtCardInDeck(\n      3,\n      'Almacenes',\n      3,\n      2,\n      'https://firebasestorage.googleapis.com/v0/b/citadels-ldaw.appspot.com/o/cards%2Fdistricts%2Fgreen%2Falmacenes.jpg?alt=media&token=7809b068-c802-48ba-b05c-ff98e2b9573a',\n    ),\n  );\n  deck.push(\n    ...districtCardInDeck(\n      4,\n      'Mercado',\n      2,\n      2,\n      'https://firebasestorage.googleapis.com/v0/b/citadels-ldaw.appspot.com/o/cards%2Fdistricts%2Fgreen%2Fmercado.jpg?alt=media&token=2b736349-d370-481c-b68f-92e7b7b343fd',\n    ),\n  );\n  deck.push(\n    ...districtCardInDeck(\n      5,\n      'Taberna',\n      1,\n      2,\n      'https://firebasestorage.googleapis.com/v0/b/citadels-ldaw.appspot.com/o/cards%2Fdistricts%2Fgreen%2Ftaberna.jpg?alt=media&token=9bbee48d-140c-4ade-b3a6-add77193041e',\n    ),\n  );\n  deck.push(\n    ...districtCardInDeck(\n      3,\n      'Puerto',\n      4,\n      2,\n      'https://firebasestorage.googleapis.com/v0/b/citadels-ldaw.appspot.com/o/cards%2Fdistricts%2Fgreen%2Fpuerto.jpg?alt=media&token=1ecf7239-773c-458f-904f-b00f650063f7',\n    ),\n  );\n  deck.push(\n    ...districtCardInDeck(\n      3,\n      'Tienda',\n      2,\n      2,\n      'https://firebasestorage.googleapis.com/v0/b/citadels-ldaw.appspot.com/o/cards%2Fdistricts%2Fgreen%2Ftienda.jpg?alt=media&token=987005d7-a83c-43f9-a255-a000259f691a',\n    ),\n  );\n  deck.push(\n    ...districtCardInDeck(\n      2,\n      'Fortaleza',\n      5,\n      3,\n      'https://firebasestorage.googleapis.com/v0/b/citadels-ldaw.appspot.com/o/cards%2Fdistricts%2Fred%2Ffortaleza.jpg?alt=media&token=4260bf11-ab74-438c-98d6-5b8d92604a58',\n    ),\n  );\n  deck.push(\n    ...districtCardInDeck(\n      3,\n      'Prisión',\n      2,\n      3,\n      'https://firebasestorage.googleapis.com/v0/b/citadels-ldaw.appspot.com/o/cards%2Fdistricts%2Fred%2Fprision.jpg?alt=media&token=edeef978-a05e-4b70-9852-f238d45113b2',\n    ),\n  );\n  deck.push(\n    ...districtCardInDeck(\n      3,\n      'Atalaya',\n      1,\n      3,\n      'https://firebasestorage.googleapis.com/v0/b/citadels-ldaw.appspot.com/o/cards%2Fdistricts%2Fred%2Fatalaya.jpg?alt=media&token=1558164b-dc8b-4e35-9254-1d966ac45240',\n    ),\n  );\n  deck.push(\n    ...districtCardInDeck(\n      3,\n      'Cuartel',\n      3,\n      3,\n      'https://firebasestorage.googleapis.com/v0/b/citadels-ldaw.appspot.com/o/cards%2Fdistricts%2Fred%2Fcuartel.jpg?alt=media&token=6aeb48c0-f5ca-445e-aeb7-0c61f39878cf',\n    ),\n  );\n  deck.push(\n    ...districtCardInDeck(\n      3,\n      'Palacio',\n      5,\n      0,\n      'https://firebasestorage.googleapis.com/v0/b/citadels-ldaw.appspot.com/o/cards%2Fdistricts%2Fyellow%2Fpalacio.jpg?alt=media&token=6139bca5-bdc1-4455-aa43-1f474594eccb',\n    ),\n  );\n  deck.push(\n    ...districtCardInDeck(\n      4,\n      'Castillo',\n      4,\n      0,\n      'https://firebasestorage.googleapis.com/v0/b/citadels-ldaw.appspot.com/o/cards%2Fdistricts%2Fyellow%2Fcastillo.jpg?alt=media&token=d3230b61-e2a6-45ea-9410-eb08224e2ccd',\n    ),\n  );\n  deck.push(\n    ...districtCardInDeck(\n      5,\n      'Señoría',\n      3,\n      0,\n      'https://firebasestorage.googleapis.com/v0/b/citadels-ldaw.appspot.com/o/cards%2Fdistricts%2Fyellow%2Fsenoria.jpg?alt=media&token=da3b04f7-b6a4-4a3b-a444-c48740308fc2',\n    ),\n  );\n\n  // Will need to keep a file or something with the distric information.\n  // for (let index = 0; index < 68; index++) {\n  //   deck.push(\n  //     CreateDistrictCard(\n  //       'Name: ' + index,\n  //       Math.floor(Math.random() * 3) + 1,\n  //       Math.floor(Math.random() * 4),\n  //     ),\n  //   );\n  // }\n  return deck;\n}\n\nexport function CreateDeckOfCharacters() {\n  const backSrc =\n    'https://firebasestorage.googleapis.com/v0/b/citadels-ldaw.appspot.com/o/cards%2Fback_gray.jpg?alt=media&token=7a1f8e7e-4a08-426a-9edd-09e60e22496a';\n  const deck = [\n    {\n      order: 1,\n      name: 'Assasin',\n      front:\n        'https://firebasestorage.googleapis.com/v0/b/citadels-ldaw.appspot.com/o/cards%2Fcharacters%2Fbase%2Fasesino.jpg?alt=media&token=03ceea66-dbc1-435d-b46e-1c1edd48b141',\n      back: backSrc,\n    },\n    {\n      order: 2,\n      name: 'Thief',\n      front:\n        'https://firebasestorage.googleapis.com/v0/b/citadels-ldaw.appspot.com/o/cards%2Fcharacters%2Fbase%2Fladron.jpg?alt=media&token=dfd057fc-3073-40ce-9053-bad997173482',\n      back: backSrc,\n    },\n    {\n      order: 3,\n      name: 'Magician',\n      front:\n        'https://firebasestorage.googleapis.com/v0/b/citadels-ldaw.appspot.com/o/cards%2Fcharacters%2Fbase%2Fmago.jpg?alt=media&token=7ee85db5-3682-486d-820b-2225fce7aea5',\n      back: backSrc,\n    },\n    {\n      order: 4,\n      name: 'King',\n      front:\n        'https://firebasestorage.googleapis.com/v0/b/citadels-ldaw.appspot.com/o/cards%2Fcharacters%2Fbase%2Frey.jpg?alt=media&token=60239d45-6c7c-424c-9b77-e2e10c38ad86',\n      back: backSrc,\n    },\n    {\n      order: 5,\n      name: 'Bishop',\n      front:\n        'https://firebasestorage.googleapis.com/v0/b/citadels-ldaw.appspot.com/o/cards%2Fcharacters%2Fbase%2Fobispo.jpg?alt=media&token=fda603aa-89c4-4692-b09a-e823940d2409',\n      back: backSrc,\n    },\n    {\n      order: 6,\n      name: 'Merchant',\n      front:\n        'https://firebasestorage.googleapis.com/v0/b/citadels-ldaw.appspot.com/o/cards%2Fcharacters%2Fbase%2Fmercader.jpg?alt=media&token=2705ddf3-cf31-47c5-9a79-56f462f43085',\n      back: backSrc,\n    },\n    {\n      order: 7,\n      name: 'Architect',\n      front:\n        'https://firebasestorage.googleapis.com/v0/b/citadels-ldaw.appspot.com/o/cards%2Fcharacters%2Fbase%2Farquitecto.jpg?alt=media&token=ee9cee94-7064-4d4e-8f81-760e2df8c772',\n      back: backSrc,\n    },\n    {\n      order: 8,\n      name: 'Warlord',\n      front:\n        'https://firebasestorage.googleapis.com/v0/b/citadels-ldaw.appspot.com/o/cards%2Fcharacters%2Fbase%2Fguerrero.jpg?alt=media&token=f56f6050-9c7f-47df-93f6-3b8d157f4b89',\n      back: backSrc,\n    },\n  ];\n  const specialCharacters = [\n    {\n      order: 1,\n      name: 'Witch',\n      front:\n        'https://firebasestorage.googleapis.com/v0/b/citadels-ldaw.appspot.com/o/cards%2Fcharacters%2Fextra%2Fbruja.jpg?alt=media&token=ecb9c8f3-0d57-49e9-802c-ef714bcbc7f9',\n      back: backSrc,\n    },\n    {\n      order: 2,\n      name: 'Tax Collector',\n      front:\n        'https://firebasestorage.googleapis.com/v0/b/citadels-ldaw.appspot.com/o/cards%2Fcharacters%2Fextra%2Frecaudador.jpg?alt=media&token=a2197f82-7bb6-4d9d-a6f5-84b84f214e06',\n      back: backSrc,\n    },\n    {\n      order: 3,\n      name: 'Wizard',\n      front:\n        'https://firebasestorage.googleapis.com/v0/b/citadels-ldaw.appspot.com/o/cards%2Fcharacters%2Fextra%2Fhechicero.jpg?alt=media&token=e6869073-ead8-49c1-8544-f4eedb17ee53',\n      back: backSrc,\n    },\n    {\n      order: 4,\n      name: 'Emperor',\n      front:\n        'https://firebasestorage.googleapis.com/v0/b/citadels-ldaw.appspot.com/o/cards%2Fcharacters%2Fextra%2Femperador.jpg?alt=media&token=090e596a-089c-419c-bc9b-e497a7c38e66',\n      back: backSrc,\n    },\n    {\n      order: 5,\n      name: 'Abbot',\n      front:\n        'https://firebasestorage.googleapis.com/v0/b/citadels-ldaw.appspot.com/o/cards%2Fcharacters%2Fextra%2Fabad.jpg?alt=media&token=ad3b577d-2a42-45ad-b55f-2c10926d60c7',\n      back: backSrc,\n    },\n    {\n      order: 6,\n      name: 'Alchemist',\n      front:\n        'https://firebasestorage.googleapis.com/v0/b/citadels-ldaw.appspot.com/o/cards%2Fcharacters%2Fextra%2Falquimista.jpg?alt=media&token=b212e452-208d-4e7a-ac49-1b86190e20b8',\n      back: backSrc,\n    },\n    {\n      order: 7,\n      name: 'Navigator',\n      front:\n        'https://firebasestorage.googleapis.com/v0/b/citadels-ldaw.appspot.com/o/cards%2Fcharacters%2Fextra%2Fnavegante.jpg?alt=media&token=ca05adf4-370b-4d40-a623-071e91c29358',\n      back: backSrc,\n    },\n    {\n      order: 8,\n      name: 'Diplomat',\n      front:\n        'https://firebasestorage.googleapis.com/v0/b/citadels-ldaw.appspot.com/o/cards%2Fcharacters%2Fextra%2Fdiplomatico.jpg?alt=media&token=2f9dc4c6-d36b-48e8-90ac-586e564aab42',\n      back: backSrc,\n    },\n    {\n      order: 9,\n      name: 'Artist',\n      front:\n        'https://firebasestorage.googleapis.com/v0/b/citadels-ldaw.appspot.com/o/cards%2Fcharacters%2Fextra%2Fartista.jpg?alt=media&token=ae23d6cf-6b55-40f1-bda4-1e25e5874069',\n      back: backSrc,\n    },\n    {\n      order: 9,\n      name: 'Queen',\n      front:\n        'https://firebasestorage.googleapis.com/v0/b/citadels-ldaw.appspot.com/o/cards%2Fcharacters%2Fextra%2Freina.jpg?alt=media&token=65331dac-2e78-4e75-9320-e176784b2111',\n      back: backSrc,\n    },\n  ];\n  return deck;\n}\n\nfunction CreateDistrictCard(name, cost, type) {\n  return {name: name, cost: cost, type: type};\n  //not sure how to do specialPower which should be a function.\n}\n\nfunction CreateCharacterCard(order, name) {\n  return {order, name};\n  //not sure how to do specialPower which should be a function.\n}\n\n// export function Cards(props) {\n//   let cards = [];\n//   for (let i = 0; i < 4; i++) {\n//     cards.push(\n//       <Card key={i} cardFrontImage={'assets/cards/cardfront.png'} isReversed={true} />,\n//     );\n//   }\n\n//   return (\n//     <div\n//       style={{\n//         width: '600px',\n//         display: 'flex',\n//         position: 'fixed',\n//         left: '50%',\n//         bottom: '50px',\n//         transform: 'translateX(-50%)',\n//       }}\n//     >\n//       {cards}\n//     </div>\n//   );\n// }\n","import { INVALID_MOVE } from 'boardgame.io/core';\n// might want to structure later for modes of game TODO\nconst gameMode = {\n  NUMCHARACTERS : 8,\n  MINPLAYERS: 2,\n  MAXPLAYERS: 7,\n}\n/**\n * Function that allows user to choose a character.\n * @param {G} G - Game state provided by boardGame.io\n * @param {ctx} ctx - ctx states provided by boardGame.io\n * @param {int} indx1 - index of deckOfCharacters that the user chose\n * @param {int} [indx2=-1] - index of deckOfCharacters to place facedown, only used when 2P grame\n */\nexport function ChooseCharacter(G, ctx, indx1, indx2 = -1) {\n  console.log(\"Entered ChooseCharacter with: \", indx1)\n  G.players[ctx.currentPlayer].chosenCharacter.splice(0,0,G.deckOfCharacters.splice(indx1,1)[0])\n\n  // if 2 players after chose place another card facedown so when 2 players two choses.\n  // First time it doesn't facedown (this is when deck of characters length === 6) \n  if (ctx.numPlayers === 2 && G.deckOfCharacters.length !== 6) {\n    if (indx1 < indx2) {\n      indx2 = indx2 - 1;\n    }\n    G.faceDownCharacterCards.push(G.deckOfCharacters.splice(indx2,1)[0])\n  }\n\n  // When playing with 7 players, when player 6 chooses move facedown to deck of characters\n  // so player 7 has two choices.\n  if (ctx.numPlayers === 7  && G.deckOfCharacters.length === 1 && ctx.playOrderPos === 5) {\n    G.deckOfCharacters.push(G.faceDownCharacterCards.pop())\n  }\n\n  // let the deck be empty for phase is over function\n  if(G.deckOfCharacters.length === 1) {\n    G.faceDownCharacterCards.push(G.deckOfCharacters.pop());\n  }\n}\n\n/**\n * Utility function to get current character from player. This works given that choosen characters are sorted in setPlayPhase() and after each turn the character is returned to deck of characters.\n * @param {G} G - Game state provided by boardGame.io\n * @param {ctx} ctx - ctx states provided by boardGame.io\n */\nexport function getCurrentCharacter(G, ctx) {\n  console.log(\"called getCurrentChar with:\" + ctx.currentPlayer)\n  let currentCharater = -1;\n  currentCharater = G.players[ctx.currentPlayer].chosenCharacter[0].order;\n  return currentCharater\n}\n\n// Send to Utils\nexport function findPlayerWithCharacter(G, ctx, characterOrder) {\n  for (let i = 0; i < ctx.numPlayers; i++) {\n    if (G.players[i].chosenCharacter.some(e => e.order === characterOrder)){\n      return i\n    }    \n  }\n  return -1;\n}\n\n/**\n * Function to take a coin in their turn.\n * @param {G} G - Game state provided by boardGame.io\n * @param {ctx} ctx - ctx states provided by boardGame.io\n */\nexport function TakeCoin(G, ctx) {\n  console.log(\"TakeCoin called\")\n  // Check if G.pileOfCoins has more thatn 2 coins.\n  \n  // If it is merchant(6) give one coin extra\n  if(getCurrentCharacter(G, ctx) === 6 && G.pileOfCoins > 1) {\n    G.players[ctx.currentPlayer].coins = G.players[ctx.currentPlayer].coins + 1;\n    G.pileOfCoins = G.pileOfCoins - 1;\n  }\n\n  if (G.pileOfCoins === 1) {\n    G.players[ctx.currentPlayer].coins = G.players[ctx.currentPlayer].coins + 1;\n    G.pileOfCoins = G.pileOfCoins - 1;\n  } else {\n    G.players[ctx.currentPlayer].coins = G.players[ctx.currentPlayer].coins + 2;\n    G.pileOfCoins = G.pileOfCoins - 2;\n  }\n\n  // If architect draw 2 district cards and add to hand\n  if(getCurrentCharacter(G, ctx) === 7 && G.deckOfCharacters.length > 2) {\n    let addCards = G.deckOfDistricts.splice(0,2)\n    G.secret[ctx.currentPlayer].hand.push(addCards[0]);\n    G.secret[ctx.currentPlayer].hand.push(addCards[1]);\n    // G.secret[ctx.currentPlayer].hand.push(G.deckOfDistricts.shift());\n    // G.secret[ctx.currentPlayer].hand.push(G.deckOfDistricts.shift());\n  }\n  \n  ctx.events.endStage();\n}\n\n/**\n * Takes top 2 district cards and allows user to choose between them\n * @param {G} G - Game state provided by boardGame.io\n * @param {ctx} ctx - ctx states provided by boardGame.io\n * @param {bool} choseFirstCard - Either chose first card or second\n */\nexport function TakeDistrictCard(G, ctx, choseFirstCard) {\n  console.log(\"TakeDistrictCard called\")\n  let first = G.deckOfDistricts.shift()\n  let second = G.deckOfDistricts.shift()\n  \n  if(choseFirstCard){\n    G.secret[ctx.currentPlayer].hand.push(first)\n    G.deckOfDistricts.push(second)\n  } else {\n    G.secret[ctx.currentPlayer].hand.push(second)\n    G.deckOfDistricts.push(first)\n  }\n\n  // If it is merchant(6) give one coin extra\n  if(getCurrentCharacter(G, ctx) === 6 && G.pileOfCoins > 1) {\n    G.players[ctx.currentPlayer].coins = G.players[ctx.currentPlayer].coins + 1;\n    G.pileOfCoins = G.pileOfCoins - 1;\n  }\n\n  // If architect draw 2 district cards and add to hand\n  if(getCurrentCharacter(G, ctx) === 7 && G.deckOfCharacters.length > 2) {\n    G.secret[ctx.currentPlayer].hand.push(G.deckOfDistricts.shift());\n    G.secret[ctx.currentPlayer].hand.push(G.deckOfDistricts.shift());\n  }\n\n  ctx.events.endStage();\n}\n\n/**\n * Utility function check weather the player still can build.\n * @param {G} G - Game state provided by boardGame.io\n * @param {ctx} ctx - ctx states provided by boardGame.io\n */\nfunction canBuild(G, ctx) {\n  let canBuild = false;\n  if(G.players[ctx.currentPlayer].districtBuiltOnTurn === 0 || (G.players[ctx.currentPlayer].districtBuiltOnTurn < 3 && getCurrentCharacter(G, ctx) === 7)){\n    canBuild = true;\n  }\n  return canBuild;\n}\n\n/**\n * Function to call when building a district card.\n * @param {G} G - Game state provided by boardGame.io\n * @param {ctx} ctx - ctx states provided by boardGame.io\n * @param {int} handIndex - index of card that is built\n */\nexport function BuildDistrict(G, ctx, handIndex) {\n  console.log(\"Entered BuildDistrict\")\n  //Do not allow if it has more than 1, unles is architect.\n  if (handIndex !== -1) {\n    if(canBuild(G, ctx)) {\n      G.players[ctx.currentPlayer].districtBuiltOnTurn = G.players[ctx.currentPlayer].districtBuiltOnTurn + 1;\n      // Check if user has sufficient coins, should be checked before allowing to select that hand.\n      if(G.players[ctx.currentPlayer].coins >= G.secret[ctx.currentPlayer].hand[handIndex].cost) {\n        G.players[ctx.currentPlayer].coins = G.players[ctx.currentPlayer].coins - G.secret[ctx.currentPlayer].hand[handIndex].cost;\n        G.pileOfCoins = G.pileOfCoins + G.secret[ctx.currentPlayer].hand[handIndex].cost;\n        G.players[ctx.currentPlayer].builtCity.push(G.secret[ctx.currentPlayer].hand.splice(handIndex,1)[0])\n      }\n    }\n    // check if it has 7 districs if yes put first to finish\n    if(G.players[ctx.currentPlayer].builtCity.length >= 7 && G.finishedFirst === -1) {\n      G.finishedFirst = ctx.currentPlayer\n    }\n  }\n  \n  // if Warlord(8) setStage('extraStage')\n  if(getCurrentCharacter(G, ctx) === 8) {\n    ctx.events.setStage('extraStage');\n  }\n}\n\n/**\n * Function to call to end or skip your turn, it returns to deck of characters your choosen card\n * and reset's powerUsed.\n * @param {G} G - Game state provided by boardGame.io\n * @param {ctx} ctx - ctx states provided by boardGame.io\n */\nexport function SkipOrEndStage(G, ctx) {\n  G.players[ctx.currentPlayer].powerUsed = false;\n  G.players[ctx.currentPlayer].districtBuiltOnTurn = 0;\n\n  // if Warlord(8) setStage('extraStage')\n  if(getCurrentCharacter(G, ctx) === 8) {\n    ctx.events.setStage('extraStage');\n  } else {\n    // move user lowest character to characterdeck\n    G.deckOfCharacters.push(G.players[ctx.currentPlayer].chosenCharacter.splice(0,1)[0]);\n    ctx.events.endStage();\n    ctx.events.endTurn();\n  }\n}\n\n/**\n * Function to call to end your turn in warloard, it returns to deck of characters your choosen card\n * and reset's powerUsed.\n * @param {G} G - Game state provided by boardGame.io\n * @param {ctx} ctx - ctx states provided by boardGame.io\n */\nexport function EndTurn(G, ctx) {\n  G.players[ctx.currentPlayer].powerUsed = false;\n  G.players[ctx.currentPlayer].districtBuiltOnTurn = 0;\n\n  // move user lowest character to characterdeck\n  G.deckOfCharacters.push(G.players[ctx.currentPlayer].chosenCharacter.splice(0,1)[0]);\n  ctx.events.endStage();\n  ctx.events.endTurn(); \n}\n\n/**\n * Changes G state to establish who to kill this turn. Effect is taken in BeginPlayTurn()\n * @param {G} G - Game state provided by boardGame.io\n * @param {ctx} ctx - ctx states provided by boardGame.io\n * @param {int} toMurder - character number to murder.\n */\nfunction assasinPower(G, ctx, toMurder) { \n  G.murderedCharacter = toMurder;\n}\n\n/**\n * Changes G state to establish who to mugg this turn. Effect is taken in BeginPlayTurn()\n * @param {G} G - Game state provided by boardGame.io\n * @param {ctx} ctx - ctx states provided by boardGame.io\n * @param {int} toSteal - character number to still from\n */\nfunction thiefPower(G, ctx, toSteal) {\n  G.muggedCharacter = {muggedFromPlayer: ctx.currentPlayer, muggedToCharacter: toSteal};\n}\n\n/**\n * Switches player hand with chosen player.\n * @param {G} G - Game state provided by boardGame.io\n * @param {ctx} ctx - ctx states provided by boardGame.io\n * @param {int} changeHandsWith - player number to switch hands with\n */\nfunction magicianPowerA(G, ctx, changeHandsWith) {\n  const resultSecret = {...G.secret};\n\n  const currentPlayerHand = [...G.secret[ctx.currentPlayer].hand];\n  resultSecret[ctx.currentPlayer].hand = G.secret[changeHandsWith].hand\n  resultSecret[changeHandsWith].hand = currentPlayerHand;\n\n  return {...G, secret : resultSecret}\n}\n\n/**\n * Switches the player hand with the deck.\n * @param {G} G - Game state provided by boardGame.io\n * @param {ctx} ctx - ctx states provided by boardGame.io\n * @param {[int]} changeMyHandIndx - array of index number from players hand to switch cards.\n */\nfunction magicianPowerB(G, ctx, changeMyHandIndx) {\n  // sort descending order\n  changeMyHandIndx.sort(function(a,b){return b-a});\n  const numOfCards = changeMyHandIndx.length;\n  changeMyHandIndx.forEach(x => {\n    G.deckOfDistricts.push(G.secret[ctx.currentPlayer].hand.splice(x,1)[0]);\n  });\n  for (let i = 0; i < numOfCards; i++) {\n    G.secret[ctx.currentPlayer].hand.push(G.deckOfDistricts.shift());\n  }\n}\n\n/**\n * Utility funtion to count how many cards of specific type of distric has the player\n * @param {G} G - Game state provided by boardGame.io\n * @param {ctx} ctx - ctx states provided by boardGame.io\n * @param {int} typeOfDistrict - type of the distric type which gives extra coins to the character\n */\nfunction getExtraCoins(G, ctx, typeOfDistrict) {\n  let goldDistrictCount = 0\n  G.players[ctx.currentPlayer].builtCity.forEach(city => {\n    if(city.type === typeOfDistrict) {\n      goldDistrictCount = goldDistrictCount + 1;\n    }\n  });\n  return goldDistrictCount\n}\n\n/**\n * Function that counts and adds coints to the character when specific type of city is built.\n * @param {G} G - Game state provided by boardGame.io\n * @param {ctx} ctx - ctx states provided by boardGame.io\n * @param {int} typeOfDistrict - type of the distric type which gives extra coins to the character\n */\nfunction addExtraCoin(G, ctx, typeOfDistrict) {\n  let addedGold = getExtraCoins(G, ctx, typeOfDistrict);\n  console.log(\"<-------Extra coins to add:\" + addedGold);\n  while(G.pileOfCoins !== 0 && addedGold !== 0) {\n    G.pileOfCoins = G.pileOfCoins - 1;\n    addedGold = addedGold - 1;\n    G.players[ctx.currentPlayer].coins = G.players[ctx.currentPlayer].coins + 1;\n  }\n}\n\n/**\n * It is the function for the extra power for the warlord to destroy a card of another player.\n * @param {G} G - Game state provided by boardGame.io\n * @param {ctx} ctx - ctx states provided by boardGame.io\n * @param {any} destroy - an object containing the player number and it's index hand card to destroy\n */\nexport function WarlordPower(G, ctx, destroy) {\n  // destroy: {\n  //  player: Int,\n  //  builtCityHandIndx: Int, \n  // }\n\n  let destroyedCity = G.players[destroy.player].builtCity.splice(destroy.builtCityHandIndx, 1)[0];\n  G.players[ctx.currentPlayer].coins =  G.players[ctx.currentPlayer].coins - (destroyedCity.cost - 1);\n  G.pileOfCoins = G.pileOfCoins + (destroyedCity.cost - 1);\n  G.deckOfDistricts.push(destroyedCity);\n  \n  // move user lowest character to characterdeck\n  G.deckOfCharacters.push(G.players[ctx.currentPlayer].chosenCharacter.splice(0,1)[0]);\n  ctx.events.endStage();\n  ctx.events.endTurn();\n}\n\n\n/**\n * Function Use character Power, thakes the current user power and uses the power of that character.\n * @param {G} G - Game state provided by boardGame.io\n * @param {ctx} ctx - ctx states provided by boardGame.io\n * @param {any} payload - different payload from the front.\n */\nexport function UseCharacterPower(G, ctx, payload) {\n  console.log(\"<----Use character Power called with payload: \"+ payload)\n  // Check on front when input:\n  // If power already used the btn is desabled.\n  // Thief can not anounce assasin and assasin target.\n  if (!G.players[ctx.currentPlayer].powerUsed) {\n    G.players[ctx.currentPlayer].powerUsed = true;\n    switch (getCurrentCharacter(G,ctx)) {\n      case 1:\n        // payload: int character order number to murder\n        assasinPower(G, ctx, payload)\n        break;\n      case 2:\n        // payload: int character order number to steal\n        thiefPower(G, ctx, payload)\n        break;\n      case 3:\n        // payload: {isOptionA: true, changeHandsWith: int, changeMyHandIndx: [int]}\n        if(payload.isOptionA) {\n          magicianPowerA(G, ctx, payload.changeHandsWith); // needs testing.\n        } else {\n          magicianPowerB(G, ctx, payload.changeMyHandIndx);\n        }\n        break;\n      case 4:\n        addExtraCoin(G, ctx, 0)\n        break;\n      case 5:\n        addExtraCoin(G, ctx, 1)\n        break;\n      case 6:\n        addExtraCoin(G, ctx, 2)\n        break;\n      case 7:\n        // No use power, just explanaition\n        break;\n      case 8:\n        addExtraCoin(G, ctx, 3)\n        break;\n      default:\n        break;\n    }\n  }\n}","import { getCurrentCharacter, findPlayerWithCharacter, EndTurn } from './Moves';\n\nexport function RemoveSecretFromPlayer(G, ctx, playerID) {\n  //return G with out secret from other players.\n  //not working locally\n  const newSecrets = { ...G.secret };\n\n  for (const key in newSecrets) {\n    console.log('key: ', key, ' PlayerID: ', playerID);\n    if (key !== playerID) {\n      newSecrets[key] = [];\n    }\n  }\n\n  return { ...G, secret: newSecrets };\n}\n\n/**\n * Returns a shifted array for Draw Phase, the player with the crown starts and goes clockwise.\n * When number of players is 2-3 they choose 2 characters.\n * @param {any} G - Game State\n * @param {any} ctx - Game context\n * @returns {array} playerOrder - Order of players in Draw Phase\n */\nexport function GetPlayerOrderDrawPhase(G, ctx) {\n  console.log('Entered GetPlayerOrderDrawPhase');\n  let playerOrder = [...Array(ctx.numPlayers).keys()];\n  let numPlayers = ctx.numPlayers;\n  if (numPlayers < 4) {\n    let doubleTurn = [...Array(ctx.numPlayers).keys()];\n    playerOrder = playerOrder.concat(doubleTurn);\n  }\n  for (let i = 0; i < G.playerWithCrown; i++) {\n    const element = playerOrder.shift();\n    playerOrder.push(element);\n  }\n  return playerOrder;\n}\n\n/**\n * Returns the ordern in which the players will take turns depending on which character they chose,\n * if they are 2-3 players they play twice.\n * @param {any} G - Game State\n * @param {any} ctx - Game context\n * @returns {array} playerOrder - Order of players in Play Phase\n */\nexport function GetPlayerOrderPlayPhase(G, ctx) {\n  let dict = {};\n  let playerWithCrown = -1;\n  for (let i = 0; i < ctx.numPlayers; i++) {\n    for (let j = 0; j < G.players[i].chosenCharacter.length; j++) {\n      let key = i + j * ctx.numPlayers;\n      dict[key] = G.players[i].chosenCharacter[j].order;\n    }\n  }\n\n  // https://stackoverflow.com/questions/1069666/sorting-object-property-by-values\n  let playerOrder = Object.keys(dict).sort(function (a, b) {\n    return dict[a] - dict[b];\n  });\n  if (ctx.numPlayers < 4) {\n    for (let i = 0; i < playerOrder.length; i++) {\n      playerOrder[i] = playerOrder[i] % ctx.numPlayers;\n    }\n  }\n\n  // Maps keys to Int.\n  playerOrder = playerOrder.map(function (x) {\n    return parseInt(x, 10);\n  });\n  console.log('GetPlayerOrderPlayPhase');\n  return playerOrder;\n}\n\nfunction getRndInteger(min, max) {\n  return Math.floor(Math.random() * (max - min)) + min;\n}\n\nfunction isKing(G, indx) {\n  let isKing = false;\n  if (G.deckOfCharacters[indx].order === 4) {\n    isKing = true;\n  }\n  return isKing;\n}\n\n/**\n * Intial set up for any number of players to start choosing characters.\n * @param {any} G - Game State\n * @param {any} ctx - Game context\n */\nexport function SetDrawPhase(G, ctx) {\n  var randomNumber = Math.floor(Math.random() * 8); //random between 0 to 8\n  G.faceDownCharacterCards.push(G.deckOfCharacters.splice(randomNumber, 1)[0]);\n  if (ctx.numPlayers < 6 && ctx.numPlayers > 3) {\n    randomNumber = Math.floor(Math.random() * 7);\n    while (isKing(G, randomNumber)) {\n      randomNumber = Math.floor(Math.random() * 7);\n    }\n    G.faceUpCharacterCards.push(G.deckOfCharacters.splice(randomNumber, 1)[0]);\n    if (ctx.numPlayers === 4) {\n      randomNumber = randomNumber = Math.floor(Math.random() * 6);\n      while (isKing(G, randomNumber)) {\n        randomNumber = Math.floor(Math.random() * 6);\n      }\n      G.faceUpCharacterCards.push(G.deckOfCharacters.splice(randomNumber, 1)[0]);\n    }\n    return G;\n  }\n}\n\n/**\n * The draw phase finished when deck of characters is empty in any case.\n * @param {any} G - Game State\n * @param {any} ctx - Game context\n */\nexport function IsDrawPhaseOver(G, ctx) {\n  let phaseIsComplete = G.deckOfCharacters.length === 0;\n  return phaseIsComplete;\n}\n\n/**\n * Function called at the start of each players action turn. This checks when the player was mugged or murdered and moves the crown.\n * @param {any} G - Game State\n * @param {any} ctx - Game context\n */\nexport function BeginPlayTurn(G, ctx) {\n  if (G.players[ctx.currentPlayer].chosenCharacter[0].order === 4) {\n    G.playerWithCrown = ctx.currentPlayer;\n  }\n\n  if (getCurrentCharacter(G, ctx) === G.murderedCharacter) {\n    console.log(\n      '<-------Player :' +\n      ctx.currentPlayer +\n      ' was murdered and lost turn with character: ' +\n      getCurrentCharacter(G, ctx),\n    );\n    EndTurn(G, ctx);\n    return G;\n  }\n\n  if (getCurrentCharacter(G, ctx) === G.muggedCharacter.muggedToCharacter) {\n    if (G.muggedCharacter.muggedToCharacter === G.murderedCharacter) {\n      console.log('Can not mugg dead people');\n    } else {\n      console.log('<-------Player :' + ctx.currentPlayer + ' was mugged: ');\n      let muggedPlayer = findPlayerWithCharacter(\n        G,\n        ctx,\n        G.muggedCharacter.muggedToCharacter,\n      );\n      G.players[G.muggedCharacter.muggedFromPlayer].coins =\n        G.players[G.muggedCharacter.muggedFromPlayer].coins +\n        G.players[muggedPlayer].coins;\n      G.players[muggedPlayer].coins = 0;\n    }\n  }\n\n  return G;\n}\n\n/**\n * Orders arr of player when two caracter are chosen.\n * @param {any} G - Game State\n * @param {any} ctx - Game context\n */\nexport function SetPlayPhase(G, ctx) {\n  let newPlayers = { ...G.players };\n  if (ctx.numPlayers < 4) {\n    for (const key in newPlayers) {\n      newPlayers[key].chosenCharacter.sort(function (a, b) {\n        return a.order - b.order;\n      });\n    }\n  }\n  return { ...G, players: newPlayers };\n}\n\nexport function IsPlayPhaseOver(G, ctx) {\n  // Considering that each play turn the character card is returned to deck of character from player who used it.\n  let deckCount =\n    G.deckOfCharacters.length +\n    G.faceDownCharacterCards.length +\n    G.faceUpCharacterCards.length;\n  return deckCount === 8;\n}\n\n/**\n * Cleans faceDownCharacterCards, faceUpCharacterCards so that deckOfCharacters is full again with 8 characters.\n * @param {any} G - Game State\n * @param {any} ctx - Game context\n */\nexport function CleanPlayPhase(G, ctx) {\n  // reset murdered character per play phase.\n  G.murderedCharacter = -1;\n  G.muggedCharacter = { muggedFromPlayer: -1, muggedToCharacter: -1 };\n\n  for (let i = 0; i < ctx.numPlayers; i++) {\n    while (G.players[i].chosenCharacter.length !== 0) {\n      G.deckOfCharacters.push(G.players[i].chosenCharacter.pop());\n    }\n  }\n\n  while (G.faceDownCharacterCards.length !== 0) {\n    G.deckOfCharacters.push(G.faceDownCharacterCards.pop());\n  }\n\n  while (G.faceUpCharacterCards.length !== 0) {\n    G.deckOfCharacters.push(G.faceUpCharacterCards.pop());\n  }\n\n  return G;\n}\n\n/**\n * Function called to check if a game is finished by some player who built 7 cities.\n * @param {any} G - Game State\n * @param {any} ctx - Game context\n * @returns {boolean} gameIsOver - If a player finished building 7 districts\n */\nexport function IsGameOver(G, ctx) {\n  let gameIsOver = false;\n  if (G.finishedFirst !== -1 && ctx.phase === \"drawPhase\") {\n    gameIsOver = true;\n  }\n  // might have to calculate here the scores. and send back to ctx.gameover\n  return gameIsOver;\n}\n\nexport function GameOver(G, ctx) {\n  let scores = {};\n\n  for (let index = 0; index < G.players.length; index++) {\n    let baseScore = 0;\n    let extra = 0;\n    let allTypes = 0;\n    let hasYellow = false;\n    let hasBlue = false;\n    let hasGreen = false;\n    let hasRed = false;\n    let hasPurple = false;\n\n    if(G.finishedFirst === index) {\n      extra = 4;\n    } else if (G.players[index].builtCity.length > 7){\n      extra = 2;\n    }\n\n    for (let j = 0; j < G.players[index].builtCity.length; j++) {\n      baseScore += G.players[index].builtCity[j].cost\n      switch (G.players[index].builtCity[j].type) {\n        case 0:\n          hasYellow = true;\n          break;\n        case 1:\n          hasBlue = true;\n          break;\n        case 2:\n          hasGreen = true;\n          break;\n        case 3:\n          hasRed = true;\n          break;\n        case 4:\n          hasPurple = true;\n          break;\n        default:\n          break;\n      }\n    }\n\n    if(hasYellow && hasBlue && hasGreen && hasRed || hasPurple){\n      allTypes = 3;\n    }\n    \n    scores[index] = baseScore + extra + allTypes;\n\n    return scores;\n  }\n  // scoring and all other things.\n  // a) player point equal to cost of all build districts.\n  // b) if it has one distric of each color +3 points\n  // c) if finished building at least 7 building +2 points\n  //    if it was the first +4 points.\n  // if tie the player with most gold coins winds.\n  // set\n}\n\nexport function GetCurrentSituation(G, ctx) {\n  console.log('Entered GetCurrentSituation');\n  // TODO sets the current situation to all other users.\n  // like, it is your turn, or it is player 0's turn, etc.\n  let currentSituation\n  currentSituation = {\n    phase: ctx.phase,\n    activePlayer: ctx.activePlayers,\n  }\n  return currentSituation;\n}","import {CreateDeckOfDistricts, CreateDeckOfCharacters} from './Cards';\nimport {\n  GetPlayerOrderDrawPhase,\n  GetPlayerOrderPlayPhase,\n  SetDrawPhase,\n  IsDrawPhaseOver,\n  BeginPlayTurn,\n  SetPlayPhase,\n  IsPlayPhaseOver,\n  CleanPlayPhase,\n  GetCurrentSituation,\n  RemoveSecretFromPlayer,\n  IsGameOver,\n  GameOver,\n} from './Logic';\nimport {\n  ChooseCharacter,\n  TakeCoin,\n  TakeDistrictCard,\n  BuildDistrict,\n  SkipOrEndStage,\n  EndTurn,\n  UseCharacterPower,\n  WarlordPower,\n} from './Moves';\nimport {GAME_NAME} from './config';\n// G {\n//   pileOfCoins : 30,\n//   deckOfDistricts: [districtCard],\n//   deckOfCharacters: [characterCard],\n//   faceDownCharacterCards: [characterCard],\n//   faceUpCharacterCards: [characterCard],\n//   playerWithCrown : Int,\n//   finishedFirst: -1,\n//   murderedCharacter: -1,\n//   muggedCharacter = {muggedFromPlayer: -1, muggedToCharacter: -1},\n//   secret: {\n//      0 : {\n//        hand: [districtCard]\n//      },\n//      ...\n//   },\n//   players : { // In round table sit order\n//      0 : {\n//            playerstate with secret and non\n//            coins: Int,\n//            builtCity: [districtCard],\n//            handCount : Int,\n//            chosenCharacter: [characterCard],\n//            powerUsed: bool,\n//            districtBuiltOnTurn: int,\n//          },\n//      1 : {},\n//      2 : {},\n//         ...\n//   }\n// }\n\n/**git\n * Shuffles the given array using Durstenfeld Shuffle\n * @param {array} array - array to shuffle\n */\nfunction Shuffle(array) {\n  for (let i = array.length - 1; i > 0; i--) {\n    const j = Math.floor(Math.random() * (i + 1));\n    [array[i], array[j]] = [array[j], array[i]];\n  }\n}\n\n/**\n * Gets the oldest player from the game to assign as King who goes\n * first in the game.\n * @returns {int} index of player.\n */\nfunction GetOldestPlayer() {\n  //TODO\n  return 0;\n}\n\n/**\n * Initial set up for one player.\n * @returns {any} JSON like set up for player.\n */\nfunction PlayerInitialSetUp() {\n  return {\n    coins: 2,\n    builtCity: [],\n    handCount: 4,\n    chosenCharacter: [],\n    powerUsed: false,\n    districtBuiltOnTurn: 0,\n  };\n}\n\n/**\n * Creates G, the game state and sets up for numPlayers in ctx\n * @param {any} ctx JSON like.\n * @returns {any} JSON like G the game state\n */\nfunction GameSetUp(ctx) {\n  let pileOfCoins = 30;\n  let deckOfDistricts = CreateDeckOfDistricts();\n  Shuffle(deckOfDistricts);\n  let deckOfCharacters = CreateDeckOfCharacters();\n  Shuffle(deckOfCharacters);\n  let faceDownCharacterCards = [];\n  let faceUpCharacterCards = [];\n  let playerWithCrown = GetOldestPlayer();\n  let finishedFirst = -1;\n  let murderedCharacter = -1;\n  let muggedCharacter = {muggedFromPlayer: -1, muggedToCharacter: -1};\n  let secret = {};\n  let players = {};\n  for (let i = 0; i < ctx.numPlayers; i++) {\n    players[i] = PlayerInitialSetUp();\n    secret[i] = {};\n    secret[i].hand = [];\n    for (let j = 0; j < 4; j++) {\n      secret[i].hand.push(deckOfDistricts.pop());\n    }\n    pileOfCoins = pileOfCoins - 2;\n  }\n  return {\n    pileOfCoins,\n    deckOfDistricts,\n    deckOfCharacters,\n    faceDownCharacterCards,\n    faceUpCharacterCards,\n    playerWithCrown,\n    finishedFirst,\n    murderedCharacter,\n    muggedCharacter,\n    secret,\n    players,\n  };\n}\n\nconst CitadelsGame = {\n  name: GAME_NAME,\n\n  setup: (ctx) => GameSetUp(ctx),\n\n  //playerView: (G, ctx, playerID) => (RemoveSecretFromPlayer(G, ctx, playerID)), //not sure it works yet.\n\n  phases: {\n    drawPhase: {\n      turn: {\n        order: {\n          // Get the initial value of playOrderPos.\n          // This is called at the beginning of the phase.\n          first: (G, ctx) => 0,\n          // Get the next value of playOrderPos.\n          // This is called at the end of each turn.\n          // The phase ends if this returns undefined.\n          next: (G, ctx) => (ctx.playOrderPos + 1) % ctx.numPlayers,\n          playOrder: (G, ctx) => GetPlayerOrderDrawPhase(G, ctx),\n        },\n        moveLimit: 1,\n      },\n      onBegin: (G, ctx) => SetDrawPhase(G, ctx), //needs test\n      moves: {ChooseCharacter},\n      endIf: (G, ctx) => IsDrawPhaseOver(G, ctx),\n      next: 'playPhase',\n      start: true,\n    },\n\n    playPhase: {\n      turn: {\n        activePlayers: {\n          currentPlayer: {stage: 'takeActionStage'},\n          next: {\n            currentPlayer: {stage: 'takeActionStage'},\n          },\n        },\n        onBegin: (G, ctx) => BeginPlayTurn(G, ctx),\n        order: {\n          first: (G, ctx) => 0,\n          next: (G, ctx) => (ctx.playOrderPos + 1) % ctx.numPlayers,\n          playOrder: (G, ctx) => GetPlayerOrderPlayPhase(G, ctx),\n        },\n        stages: {\n          takeActionStage: {\n            moves: {TakeCoin, TakeDistrictCard, UseCharacterPower},\n            next: 'buildStage',\n          },\n          buildStage: {\n            moves: {BuildDistrict, SkipOrEndStage, UseCharacterPower},\n          },\n          extraStage: {\n            moves: {WarlordPower, EndTurn},\n          },\n        },\n      },\n      onBegin: (G, ctx) => SetPlayPhase(G, ctx),\n      endIf: (G, ctx) => IsPlayPhaseOver(G, ctx),\n      onEnd: (G, ctx) => CleanPlayPhase(G, ctx), //needs test\n      next: 'drawPhase',\n    },\n  },\n\n  minPlayers: 2,\n  maxPlayers: 7,\n\n  endIf: (G, ctx) => IsGameOver(G, ctx),\n\n  onEnd: (G, ctx) => GameOver(G, ctx),\n\n  // Disable undo feature for all the moves in the game\n  disableUndo: true,\n};\n\nexport default CitadelsGame;\n","function IsMyTurn(currentPlayer, playerID) {\n  console.log(currentPlayer);\n  console.log(playerID);\n  let isMyTurn = false;\n  if (currentPlayer === playerID) {\n    isMyTurn = true;\n  }\n  return isMyTurn\n}\n\nfunction HashOfString(string) {\n  var hash = 0, i, chr;\n    for (i = 0; i < string.length; i++) {\n      chr   = string.charCodeAt(i);\n      hash  = ((hash << 5) - hash) + chr;\n      hash |= 0; // Convert to 32bit integer\n    }\n    return hash;\n}\n\nfunction FindPlayerWithCharacter(G, numPlayers, characterOrder) {\n  for (let i = 0; i < numPlayers; i++) {\n    if (G.players[i].chosenCharacter.some(e => e.order === characterOrder)){\n      return i\n    }    \n  }\n  return -1;\n}\n\n/**\n * Utility function check weather the player still can build.\n * @param {G} G - Game state provided by boardGame.io\n * @param {ctx} ctx - ctx states provided by boardGame.io\n */\nfunction CanBuild(G, ctx) {\n  let canBuild = false;\n  if(G.players[ctx.currentPlayer].districtBuiltOnTurn === 0 || (G.players[ctx.currentPlayer].districtBuiltOnTurn < 3 && getCurrentCharacter(G, ctx) === 7)){\n    canBuild = true;\n  }\n  return canBuild;\n}\n\n/**\n * Utility function to get current character from player. This works given that choosen characters are sorted in setPlayPhase() and after each turn the character is returned to deck of characters.\n * @param {G} G - Game state provided by boardGame.io\n * @param {ctx} ctx - ctx states provided by boardGame.io\n */\nfunction getCurrentCharacter(G, ctx) {\n  console.log(\"called getCurrentChar with:\" + ctx.currentPlayer)\n  let currentCharater = -1;\n  currentCharater = G.players[ctx.currentPlayer].chosenCharacter[0].order;\n  return currentCharater\n}\n\nfunction GetCurrentSituation(G, ctx) {\n  console.log('Entered GetCurrentSituation', ctx.phase, ctx.activePlayers);\n  // TODO sets the current situation to all other users.\n  // like, it is your turn, or it is player 0's turn, etc.\n  let currentSituation\n  currentSituation = {\n    phase: ctx.phase,\n    activePlayer: ctx.activePlayers != null ? ctx.activePlayers[0] : \"none\", \n  }\n  return currentSituation;\n}\n\nexport {IsMyTurn, HashOfString, FindPlayerWithCharacter, CanBuild, GetCurrentSituation};\n","/*\n * Copyright 2018 The boardgame.io Authors\n *\n * Use of this source code is governed by a MIT-style\n * license that can be found in the LICENSE file or at\n * https://opensource.org/licenses/MIT.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\n\nconst Logo = ({ width, height }) => (\n  <svg\n    width={width || 128}\n    height={height || 128}\n    xmlns=\"http://www.w3.org/2000/svg\"\n    viewBox=\"0 0 128 128\"\n  >\n    <path\n      d=\"M64,120.37,15.27,92.28V35.91L64,7.82l48.73,28.09V92.28Z\"\n      fill=\"#373748\"\n    />\n    <path\n      fill=\"#000\"\n      d=\"M64,124,12,94V34L64,4l52,30V94ZM18.33,90.37,64,116.74l45.67-26.37V37.63L64,11.26,18.33,37.63Z\"\n    />\n    <path\n      d=\"M81.77,43.17c5.92,0,10.51,1.72,13.57,5.16,3.25,3.44,4.77,8.41,4.77,14.71q0,10.32-5.15,16.06c-3.44,3.82-8.22,5.73-14.53,5.73-5.92,0-10.51-1.72-13.56-5.35-3.25-3.63-4.78-8.6-4.78-15.29s1.72-12,5.16-15.67S75.46,43.17,81.77,43.17Zm-.57,5.16c-4.4,0-7.45,1.15-9.56,3.63s-3,6.31-3,11.66c0,5.73,1,9.74,3,12.42,2.11,2.48,5.16,3.82,9.56,3.82s7.64-1.34,9.74-3.82,3.25-6.5,3.25-11.85c0-5.54-1.15-9.55-3.25-12C88.65,49.48,85.59,48.33,81.2,48.33Z\"\n      fill=\"#fff\"\n    />\n    <path\n      d=\"M39.35,71.45l.19,12.8H33.43L33.62,72l-.19-28.48h6.11l-.19,27.9Z\"\n      fill=\"#fff\"\n    />\n  </svg>\n);\n\nLogo.propTypes = {\n  width: PropTypes.string,\n  height: PropTypes.string,\n};\n\nexport default Logo;\n","/*\n * Copyright 2018 The boardgame.io Authors\n *\n * Use of this source code is governed by a MIT-style\n * license that can be found in the LICENSE file or at\n * https://opensource.org/licenses/MIT.\n */\n\nimport React from 'react';\n\nconst UIContext = React.createContext();\n\nexport default UIContext;\n","/*\n * Copyright 2017 The boardgame.io Authors\n *\n * Use of this source code is governed by a MIT-style\n * license that can be found in the LICENSE file or at\n * https://opensource.org/licenses/MIT.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport Logo from './logo';\nimport UIContext from './ui-context';\nimport { Draggable, DragComponent } from 'react-dragtastic';\nimport './card.css';\n\nexport function GetDraggable(props, classNames, cardStyle, onClick) {\n  /* eslint-disable-next-line react/display-name */\n  return ({ isActive, events }) => {\n    return (\n      <div\n        className={classNames.join(' ')}\n        style={{\n          ...props.style,\n          ...cardStyle,\n          opacity: isActive ? 0 : 1,\n          pointerEvents: isActive ? 'none' : 'all',\n        }}\n        onClick={onClick}\n        {...events}\n      >\n        {props.isFaceUp ? props.front : props.back}\n      </div>\n    );\n  };\n}\n\nexport function GetDragComponent(\n  props,\n  classNames,\n  ref,\n  isOverAcceptedCallback\n) {\n  /* eslint-disable-next-line react/display-name, react/prop-types */\n  return ({ x, y, isOverAccepted, currentlyHoveredDroppableId }) => {\n    const classes = [...classNames];\n    /* eslint-disable-next-line react/prop-types */\n    let content = props.back;\n\n    isOverAcceptedCallback(isOverAccepted);\n\n    /* eslint-disable-next-line react/prop-types */\n    if (props.isFaceUp) {\n      /* eslint-disable-next-line react/prop-types */\n      content = props.front;\n    }\n\n    if (currentlyHoveredDroppableId !== null) {\n      if (isOverAccepted) {\n        classes.push('accept');\n      } else {\n        classes.push('reject');\n      }\n    }\n\n    return (\n      <div\n        className={classes.join(' ')}\n        ref={ref}\n        style={{\n          cursor: 'pointer',\n          borderWidth: 2,\n          pointerEvents: 'none',\n          position: 'fixed',\n          zIndex: 2000000000,\n          boxShadow: '5px 5px 5px #eee',\n          left: x - 50,\n          top: y - 70,\n        }}\n      >\n        {content}\n      </div>\n    );\n  };\n}\n/* eslint-enable */\n\nexport class CardImpl extends React.Component {\n  static propTypes = {\n    isFaceUp: PropTypes.bool,\n    front: PropTypes.node,\n    back: PropTypes.node,\n    className: PropTypes.string,\n    dragZone: PropTypes.string,\n    style: PropTypes.any,\n    onClick: PropTypes.func,\n    context: PropTypes.any,//.isRequired,\n    inDeck: PropTypes.bool,\n    data: PropTypes.any,\n    deckPosition: PropTypes.number,\n    highlighted: PropTypes.any,\n  };\n\n  static defaultProps = {\n    onClick: () => {},\n    isFaceUp: false,\n    dragZone: 'bgio-card',\n    front: <div className=\"bgio-card__front\">Card</div>,\n    back: (\n      <div className=\"bgio-card__back\">\n        <Logo width=\"48\" />\n      </div>\n    ),\n  };\n\n  constructor(props) {\n    super(props);\n    //this.id = props.context.genID();\n    this.dragComponentRef = React.createRef();\n    this.isOverAccepted = false;\n  }\n\n  onClick = () => {\n    this.props.onClick(this.props.data);\n  };\n\n  render() {\n    const classNames = ['bgio-card'];\n    if (this.props.className) {\n      classNames.push(this.props.className);\n    }\n\n    let cardStyle = {};\n\n    if (this.props.inDeck) {\n      cardStyle = {\n        position: 'absolute',\n        zIndex: this.props.deckPosition,\n      };\n    }\n\n    return (\n      <div>\n        <Draggable\n          id={this.id}\n          type={this.props.dragZone}\n          data={this.props.data}\n        >\n          {GetDraggable(this.props, classNames, cardStyle, this.onClick)}\n        </Draggable>\n\n        <DragComponent for={this.id}>\n          {GetDragComponent(\n            this.props,\n            classNames,\n            this.dragComponentRef,\n            o => (this.isOverAccepted = o)\n          )}\n        </DragComponent>\n      </div>\n    );\n  }\n}\n\nconst Card = props => (\n  <UIContext.Consumer>\n    {context => <CardImpl {...props} context={context} />}\n  </UIContext.Consumer>\n);\n\nexport { Card };\n","import React, { useState, useContext } from 'react';\nimport { Dialog, DialogTitle, DialogContent, DialogActions, Button, Checkbox, Select, InputLabel, MenuItem } from '@material-ui/core';\nimport { Card } from '../bgioComponents/card';\nimport UIContext from '../bgioComponents/ui-context';\nimport { HashOfString, CanBuild } from './Utiliy';\n\nfunction ChooseCharacterDialog({\n  deckOfCharacters,\n  faceDownCharacterCards,\n  faceUpCharacterCards,\n  ChooseCharacter,\n}) {\n  const [dialogOpen, setDialogOpen] = useState(false);\n  // TODO : implement for two players in which you choose two.\n  const [chosenCharacter, setChosenCharacter] = useState({\n    value1: -1,\n    value2: -1,\n  });\n  const uicontext = useContext(UIContext);\n\n  const handleClickOpen = () => {\n    setDialogOpen(true);\n  };\n\n  const handleClose = () => {\n    setDialogOpen(false);\n    ChooseCharacter(chosenCharacter.value1, chosenCharacter.value2);\n  };\n\n  let cardsNotAvailable = [];\n  let cardsToChoose = [];\n\n  // Rendering face down cards\n  faceDownCharacterCards.forEach((cardElement) => {\n    const image = (\n      <img\n        width=\"100px\"\n        height=\"140px\"\n        src={cardElement.back}\n        alt=\"Card-Face-Down\"\n        width=\"100px\"\n        height=\"140px\"\n      />\n    );\n    cardsNotAvailable.push(\n      <Card\n        back={image}\n        isFaceUp={false}\n        canHover={false}\n        className=\"card\"\n        key={HashOfString(cardElement.name)}\n        context={uicontext}\n      />,\n    );\n  });\n\n  // Render face up cards\n  faceUpCharacterCards.forEach((cardElement) => {\n    let keyIndx = 0;\n    const image = (\n      <img\n        width=\"100px\"\n        height=\"140px\"\n        src={cardElement.front}\n        alt={cardElement.name + '-Card-Front'}\n      />\n    );\n    cardsNotAvailable.push(\n      <Card\n        front={image}\n        isFaceUp={true}\n        canHover={false}\n        className=\"card\"\n        key={cardElement.name}\n        context={uicontext}\n      />,\n    );\n    keyIndx = keyIndx + 1;\n  });\n  cardsToChoose.push(<br></br>);\n\n  // Reneder choosable cards\n  for (let index = 0; index < deckOfCharacters.length; index++) {\n    const image = (\n      <img\n        width=\"100px\"\n        height=\"140px\"\n        src={deckOfCharacters[index].front}\n        alt={deckOfCharacters[index].name + '-Card-Front'}\n      />\n    );\n    cardsToChoose.push(\n      <Card\n        front={image}\n        isFaceUp={true}\n        canHover={true}\n        className=\"highlight\"\n        key={deckOfCharacters[index].name}\n        onClick={() => {\n          setChosenCharacter({ value1: index, value2: -1 });\n          console.log({ index });\n        }}\n        context={uicontext}\n      />,\n    );\n  }\n\n  return (\n    <div>\n      <Button variant=\"outlined\" color=\"primary\" onClick={handleClickOpen}>\n        Choose Character\n      </Button>\n      <Dialog\n        open={dialogOpen}\n        disableBackdropClick={true}\n        disableEscapeKeyDown={true}\n        fullWidth={true}\n        aria-labelledby=\"form-dialog-title\"\n      >\n        <DialogTitle id=\"form-dialog-title\">Choose Character</DialogTitle>\n        <DialogContent>\n          <div style={{ display: 'flex', flexDirection: 'row' }}>{cardsNotAvailable}</div>\n          <div style={{ margin: '10px 0' }}>Personajes para elegir</div>\n          <div style={{ display: 'flex', flexDirection: 'row' }}>{cardsToChoose}</div>\n        </DialogContent>\n        <DialogActions>\n          <Button onClick={handleClose} color=\"primary\">\n            Choose\n          </Button>\n        </DialogActions>\n      </Dialog>\n    </div>\n  );\n}\n\nfunction ShowPlayers({ numPlayers, setPayload, currentPlayer }) {\n  let players = []\n  for (let index = 0; index < numPlayers; index++) {\n    if (index == currentPlayer) {\n      const image = <img width=\"100px\" height=\"140px\" src={\"\"} alt={\"Card-Face-Down\"} />\n      players.push(\n        <Card\n          back={image}\n          isFaceUp={false}\n          canHover={false}\n          className='card'\n          key={\"Player \" + index}\n        />\n      );\n    } else {\n      const image = <img width=\"100px\" height=\"140px\" src={\"\"} alt={\"Player \" + index} />\n      players.push(\n        <Card\n          front={image}\n          isFaceUp={true}\n          canHover={true}\n          className='highlight'\n          key={\"Player \" + index}\n          onClick={() => { setPayload({ isOptionA: true, changeHandsWith: index, changeMyHandIndx: [] }); }}\n        />\n      );\n    }\n  }\n\n  return (\n    players\n  );\n}\n\nfunction ShowHand({ hand, setPayload }) {\n  let handCards = [];\n  const [selectedCards, setSelectedCards] = useState([]);\n\n  const handleClick = (index) => {\n    // TODO : highlight cards\n    let containIndx = selectedCards.findIndex(element => element === index);\n    if (containIndx !== -1) {\n      setSelectedCards([...selectedCards.slice(0, containIndx), selectedCards.slice(0, containIndx)])\n    } else {\n      setSelectedCards([...selectedCards, index]);\n    }\n\n    setPayload({ isOptionA: false, changeHandsWith: -1, changeMyHandIndx: selectedCards });\n  }\n\n  for (let index = 0; index < hand.length; index++) {\n    const image = <img width=\"100px\" height=\"140px\" src={hand[index].front} alt={hand[index].name + \"-Card-Front\"} />\n    handCards.push(\n      <Card\n        front={image}\n        isFaceUp={true}\n        canHover={true}\n        className='highlight'\n        key={\"Player \" + index}\n        onClick={() => handleClick(index)}\n      />\n    );\n  }\n\n  return (\n    handCards\n  );\n}\n\nfunction UseCharacterPowerDialog({ characterNumber, murderedCharacter, numPlayers, hand, currentPlayer, useCharacterBtn, setUseCharacterBtn, UseCharacterPower }) {\n  const [dialogOpen, setDialogOpen] = useState(false);\n  const uicontext = useContext(UIContext);\n  const [payload, setPayload] = useState();\n  const [checkBox, setCheckBox] = useState(false);\n\n  const backSrc = \"https://firebasestorage.googleapis.com/v0/b/citadels-ldaw.appspot.com/o/cards%2Fback_gray.jpg?alt=media&token=7a1f8e7e-4a08-426a-9edd-09e60e22496a\";\n  const deck = [\n    { order: 1, name: \"Assasin\", front: \"https://firebasestorage.googleapis.com/v0/b/citadels-ldaw.appspot.com/o/cards%2Fcharacters%2Fbase%2Fasesino.jpg?alt=media&token=03ceea66-dbc1-435d-b46e-1c1edd48b141\", back: backSrc },\n    { order: 2, name: \"Thief\", front: \"https://firebasestorage.googleapis.com/v0/b/citadels-ldaw.appspot.com/o/cards%2Fcharacters%2Fbase%2Fladron.jpg?alt=media&token=dfd057fc-3073-40ce-9053-bad997173482\", back: backSrc },\n    { order: 3, name: \"Magician\", front: \"https://firebasestorage.googleapis.com/v0/b/citadels-ldaw.appspot.com/o/cards%2Fcharacters%2Fbase%2Fmago.jpg?alt=media&token=7ee85db5-3682-486d-820b-2225fce7aea5\", back: backSrc },\n    { order: 4, name: \"King\", front: \"https://firebasestorage.googleapis.com/v0/b/citadels-ldaw.appspot.com/o/cards%2Fcharacters%2Fbase%2Frey.jpg?alt=media&token=60239d45-6c7c-424c-9b77-e2e10c38ad86\", back: backSrc },\n    { order: 5, name: \"Bishop\", front: \"https://firebasestorage.googleapis.com/v0/b/citadels-ldaw.appspot.com/o/cards%2Fcharacters%2Fbase%2Fobispo.jpg?alt=media&token=fda603aa-89c4-4692-b09a-e823940d2409\", back: backSrc },\n    { order: 6, name: \"Merchant\", front: \"https://firebasestorage.googleapis.com/v0/b/citadels-ldaw.appspot.com/o/cards%2Fcharacters%2Fbase%2Fmercader.jpg?alt=media&token=2705ddf3-cf31-47c5-9a79-56f462f43085\", back: backSrc },\n    { order: 7, name: \"Architect\", front: \"https://firebasestorage.googleapis.com/v0/b/citadels-ldaw.appspot.com/o/cards%2Fcharacters%2Fbase%2Farquitecto.jpg?alt=media&token=ee9cee94-7064-4d4e-8f81-760e2df8c772\", back: backSrc },\n    { order: 8, name: \"Warlord\", front: \"https://firebasestorage.googleapis.com/v0/b/citadels-ldaw.appspot.com/o/cards%2Fcharacters%2Fbase%2Fguerrero.jpg?alt=media&token=f56f6050-9c7f-47df-93f6-3b8d157f4b89\", back: backSrc },\n  ]\n\n  const handleClickOpen = () => {\n    setDialogOpen(true);\n  };\n\n  const handleClose = () => {\n    setDialogOpen(false);\n    setUseCharacterBtn(true);\n    UseCharacterPower(payload);\n  }\n\n  const handleChange = (event) => {\n    setCheckBox(event.target.checked);\n  }\n\n  let dialogContent = [];\n\n  switch (characterNumber) {\n    case 1:\n      console.log(\"ENTEred\");\n      for (let index = 1; index < deck.length; index++) {\n        const image = <img width=\"100px\" height=\"140px\" src={deck[index].front} alt={deck[index].name + \"-Card-Front\"} />\n        dialogContent.push(\n          <Card\n            front={image}\n            isFaceUp={true}\n            canHover={true}\n            className='highlight'\n            key={deck[index].name}\n            onClick={() => setPayload(index)}\n            context={uicontext}\n          />\n        );\n      }\n      break;\n    case 2:\n      for (let index = 2; index < deck.length; index++) {\n        if (index === murderedCharacter) {\n          const image = <img width=\"100px\" height=\"140px\" src={deck[index].back} alt={\"Card-Face-Down\"} />\n          dialogContent.push(\n            <Card\n              back={image}\n              isFaceUp={false}\n              canHover={false}\n              className='card'\n              key={HashOfString(deck[index].name)}\n              context={uicontext}\n            />\n          );\n        } else {\n          const image = <img width=\"100px\" height=\"140px\" src={deck[index].front} alt={deck[index].name + \"-Card-Front\"} />\n          dialogContent.push(\n            <Card\n              front={image}\n              isFaceUp={true}\n              canHover={true}\n              className='highlight'\n              key={deck[index].name}\n              onClick={() => { setPayload(index); }}\n              context={uicontext}\n            />\n          );\n        }\n      }\n      break;\n    case 3:\n      dialogContent.push(\n        <div>\n          <Checkbox\n            label=\"Option A\"\n            checked={checkBox}\n            onChange={handleChange}\n            name=\"checkOption\"\n            color=\"primary\"\n          />\n          {checkBox\n            ? <ShowPlayers numPlayers={numPlayers} setPayload={setPayload} currentPlayer={currentPlayer}></ShowPlayers>\n            : <ShowHand hand={hand} setPayload={setPayload}></ShowHand>\n          }\n        </div>\n      );\n      break;\n  }\n\n  return (\n    <div>\n      { characterNumber > 3\n        ? <div>\n          <Button variant=\"outlined\" color=\"primary\" disabled={useCharacterBtn} onClick={() => UseCharacterPower(-1)}>\n            Use Character Power\n            </Button>\n        </div>\n        : <div>\n          <Button variant=\"outlined\" color=\"primary\" disabled={useCharacterBtn} onClick={handleClickOpen}>\n            UseCharacterPower\n            </Button>\n          <Dialog open={dialogOpen}\n            fullWidth={true}\n            aria-labelledby=\"form-dialog-title\">\n            <DialogTitle id=\"form-dialog-title\">Use Power</DialogTitle>\n            <DialogContent>\n              {dialogContent}\n            </DialogContent>\n            <DialogActions>\n              <Button onClick={handleClose} color=\"primary\">\n                Use Power\n                </Button>\n            </DialogActions>\n          </Dialog>\n        </div>\n      }\n    </div>\n  )\n}\n\nfunction TakeActionDialog({ pileOfCoins, deckOfDistricts, setEndStageBtn, setBuildDistrictBtn, takeActionBtn, setTakeActionBtn, TakeCoin, TakeDistrictCard }) {\n  const [dialogOpen, setDialogOpen] = useState(false);\n  const uicontext = useContext(UIContext);\n  const [action, setAction] = useState(\"\");\n\n  const handleClickOpen = () => {\n    setDialogOpen(true);\n  };\n\n  const handleClose = () => {\n    setDialogOpen(false);\n    setBuildDistrictBtn(false);\n    setEndStageBtn(false);\n    setTakeActionBtn(true);\n\n    if (action === \"takeCoin\") {\n      TakeCoin();\n    } else if (action === \"takeDistrict0\") {\n      TakeDistrictCard(true);\n    } else if (action === \"takeDistrict1\") {\n      TakeDistrictCard(false);\n    }\n\n  }\n\n  let takeActionOptions = []\n\n  // Adding option for coins\n  if (pileOfCoins > 2) {\n    if (pileOfCoins === 1) {\n      const image = <img width=\"100px\" height=\"140px\" src={\"https://firebasestorage.googleapis.com/v0/b/citadels-ldaw.appspot.com/o/cards%2Fone_coin.jpg?alt=media&token=5c54886b-6975-440f-84d9-98f372045981\"} alt={\"One-Coin-Card\"} />\n      takeActionOptions.push(\n        <Card\n          front={image}\n          isFaceUp={true}\n          canHover={true}\n          className='highlight'\n          key={\"One-Coin\"}\n          onClick={() => { setAction(\"takeCoin\") }}\n          context={uicontext}\n        />\n      );\n    } else {\n      const image = <img width=\"100px\" height=\"140px\" src={\"https://firebasestorage.googleapis.com/v0/b/citadels-ldaw.appspot.com/o/cards%2Ftwo_coin.jpg?alt=media&token=71911bbd-817d-44ec-9922-da8af74e91ee\"} alt={\"Two-Coin-Card\"} />\n      takeActionOptions.push(\n        <Card\n          front={image}\n          isFaceUp={true}\n          canHover={true}\n          className='highlight'\n          key={\"Two-Coins\"}\n          onClick={() => { setAction(\"takeCoin\") }}\n          context={uicontext}\n        />\n      );\n    }\n  }\n\n  // Adding district card options\n  if (deckOfDistricts.length > 2) {\n    if (deckOfDistricts.length !== 1) {\n      const image = <img width=\"100px\" height=\"140px\" src={deckOfDistricts[1].front} alt={deckOfDistricts[1].name + \"-Card-Front\"} />\n      takeActionOptions.push(\n        <div>\n          <Card\n            front={image}\n            isFaceUp={true}\n            canHover={true}\n            className='highlight'\n            key={deckOfDistricts[1].name}\n            onClick={() => { setAction(\"takeDistrict1\") }}\n            context={uicontext}\n          />\n          <div>Elegir {deckOfDistricts[1].name}</div>\n        </div>\n      );\n    }\n    const image = <img width=\"100px\" height=\"140px\" src={deckOfDistricts[0].front} alt={deckOfDistricts[0].name + \"-Card-Front\"} />\n    takeActionOptions.push(\n      <div>\n        <Card\n          front={image}\n          isFaceUp={true}\n          canHover={true}\n          className='highlight'\n          key={deckOfDistricts[0].name}\n          onClick={() => { setAction(\"takeDistrict0\") }}\n          context={uicontext}\n        />\n        <div>Elegir {deckOfDistricts[0].name}</div>\n      </div>\n    );\n  }\n\n  return (\n    <div>\n      <Button variant=\"outlined\" color=\"primary\" disabled={takeActionBtn} onClick={handleClickOpen}>\n        Take Action\n      </Button>\n      <Dialog open={dialogOpen}\n        fullWidth={true}\n        aria-labelledby=\"form-dialog-title\">\n        <DialogTitle id=\"form-dialog-title\">Choose which action</DialogTitle>\n        <DialogContent>\n          {takeActionOptions}\n        </DialogContent>\n        <DialogActions>\n          <Button onClick={handleClose} color=\"primary\">\n            Action\n          </Button>\n        </DialogActions>\n      </Dialog>\n    </div>\n  )\n}\n\nfunction BuildDistricDialog({ props, hand, coins, buildDistrictBtn, setBuildDistrictBtn, BuildDistrict, setDestroyBtn }) {\n\n  const [districtToBuild, setDistrictToBuild] = useState(-1);\n  const [dialogOpen, setDialogOpen] = useState(false);\n  const uicontext = useContext(UIContext);\n\n  const handleClickOpen = () => {\n    setDialogOpen(true);\n  };\n\n  const handleClick = (index, cost, coins) => {\n    // TODO: Highlight current card and not others\n    if (cost <= coins) {\n      setDistrictToBuild(index);\n    } else {\n      console.log(\"Can not use because it is expensive. show alert.\")\n    }\n  }\n\n  const handleClose = (props) => {\n    if (CanBuild(props.G, props.ctx)) {\n      setBuildDistrictBtn(false);\n    } else {\n      setBuildDistrictBtn(true);\n    }\n    setBuildDistrictBtn(true);\n    setDialogOpen(false);\n    setDestroyBtn(false);\n    BuildDistrict(districtToBuild);\n  }\n\n  let buildOptions = []\n\n  for (let index = 0; index < hand.length; index++) {\n    const image = <img width=\"100px\" height=\"140px\" src={hand[index].front} alt={hand[index].name + \"-Card-Front\"} />\n    buildOptions.push(\n      <Card\n        front={image}\n        isFaceUp={true}\n        canHover={true}\n        className='highlight'\n        key={hand[index].name + \"-Card-Front\"}\n        onClick={() => handleClick(index, hand[index].cost, coins)}\n        context={uicontext}\n      />\n    );\n  }\n\n  return (\n    <div>\n      <Button variant=\"outlined\" color=\"primary\" disabled={buildDistrictBtn} onClick={handleClickOpen}>\n        Build Distric\n      </Button>\n      <Dialog open={dialogOpen}\n        fullWidth={true}\n        aria-labelledby=\"form-dialog-title\">\n        <DialogTitle id=\"form-dialog-title\">Build District</DialogTitle>\n        <DialogContent>\n          {buildOptions}\n        </DialogContent>\n        <DialogActions>\n          <Button onClick={() => handleClose(props)} color=\"primary\">\n            Build\n          </Button>\n        </DialogActions>\n      </Dialog>\n    </div>\n  )\n}\n\nfunction PlayerHand({ hand, coins, setPayLoad, playerID }) {\n  let handCards = [];\n\n  const handleClick = (index) => {\n    setPayLoad({ player: playerID, builtCityHandIndx: index });\n  }\n\n  const handleClickNot = (index) => {\n    // TODO: show alert or highlight red\n    console.log(\"Not sufficient to destroy\");\n  }\n\n  for (let index = 0; index < hand.length; index++) {\n    if (hand[index].cost > coins) {\n      const image = <img width=\"100px\" height=\"140px\" src={hand[index].front} alt={hand[index].name + \"-Card-Front\"} />\n      handCards.push(\n        <Card\n          front={image}\n          isFaceUp={true}\n          canHover={true}\n          className='highlight'\n          key={hand[index].name}\n          onClick={() => handleClickNot(index)}\n        />\n      );\n    } else {\n      const image = <img width=\"100px\" height=\"140px\" src={hand[index].front} alt={hand[index].name + \"-Card-Front\"} />\n      handCards.push(\n        <Card\n          front={image}\n          isFaceUp={true}\n          canHover={true}\n          className='highlight'\n          key={hand[index].name}\n          onClick={() => handleClick(index)}\n        />\n      );\n    }\n  }\n\n  return (\n    handCards\n  );\n}\n\nfunction DestroyDistricDialog({ hands, bishopPlayerID, coins, WarlordPower, EndTurn, setEndStageBtn, setBuildDistrictBtn, setTakeActionBtn, setUseCharacterBtn, destroyBtn, setDestroyBtn }) {\n  const [dialogOpen, setDialogOpen] = useState(false);\n  const [payLoad, setPayLoad] = useState({ player: -1, builtCityHandIndx: -1 })\n  const [playerID, setPlayerID] = useState(0);\n  const uicontext = useContext(UIContext);\n\n  const handleClickOpen = () => {\n    setDialogOpen(true);\n  };\n\n  const handleClose = () => {\n    setDestroyBtn(true);\n    setDialogOpen(false);\n    setEndStageBtn(true);\n    setBuildDistrictBtn(true);\n    setTakeActionBtn(false);\n    setUseCharacterBtn(false);\n    WarlordPower(payLoad);\n  }\n\n  const handleCloseEnd = () => {\n    setDestroyBtn(true);\n    setDialogOpen(false);\n    setEndStageBtn(true);\n    setBuildDistrictBtn(true);\n    setTakeActionBtn(false);\n    setUseCharacterBtn(false);\n    EndTurn();\n  }\n\n  const handleChange = (event) => {\n    console.log(\"Handle Change value\", event.target.value);\n    setPlayerID(event.target.value);\n  };\n\n  let menuItems = []\n\n  for (let index = 0; index < hands.length; index++) {\n    console.log(\"HAND:!\", hands.length)\n    if (index !== bishopPlayerID) {\n      menuItems.push(\n        <MenuItem value={index}>Player {index}</MenuItem>\n      );\n    }\n  }\n\n  let distroyDialogContent = []\n\n  distroyDialogContent.push(\n    <div>\n      <InputLabel id=\"playerToDestroy\">Player Num</InputLabel>\n      <Select\n        labelId=\"playerToDestroy\"\n        id=\"playerToDestroy-select\"\n        value={playerID}\n        onChange={handleChange}\n      >\n        {menuItems}\n      </Select>\n      <PlayerHand hand={hands[playerID]} coins={coins} setPayLoad={setPayLoad} playerID={playerID}></PlayerHand>\n    </div>\n  );\n\n\n  return (\n    <div>\n      <Button variant=\"outlined\" color=\"primary\" disabled={destroyBtn} onClick={handleClickOpen}>\n        Destroy\n      </Button>\n      <Dialog open={dialogOpen}\n        fullWidth={true}\n        aria-labelledby=\"form-dialog-title\">\n        <DialogTitle id=\"form-dialog-title\">Destroy Distric</DialogTitle>\n        <DialogContent>\n          {distroyDialogContent}\n        </DialogContent>\n        <DialogActions>\n          <Button onClick={handleClose} color=\"primary\">\n            Destroy\n          </Button>\n          <Button onClick={handleCloseEnd} color=\"secondary\">\n            End Turn\n          </Button>\n        </DialogActions>\n      </Dialog>\n    </div>\n  )\n}\n\nexport { ChooseCharacterDialog, UseCharacterPowerDialog, TakeActionDialog, BuildDistricDialog, DestroyDistricDialog };","import React from 'react';\nimport {makeStyles} from '@material-ui/core/styles';\nimport Card from '@material-ui/core/Card';\nimport CardContent from '@material-ui/core/CardContent';\nimport Typography from '@material-ui/core/Typography';\n\nimport {BiDollarCircle} from 'react-icons/bi';\nimport {FaCity} from 'react-icons/fa';\nimport {GiCardBurn} from 'react-icons/gi';\nimport {Tooltip} from '@material-ui/core';\n\nconst useStyles = makeStyles({\n  root: {\n    width: 275,\n    padding: 8,\n    '&:last-child': {\n      paddingBottom: '8 !important',\n    },\n  },\n});\n\nfunction PlayerCard(props) {\n  const classes = useStyles();\n\n  console.log('Player Card');\n  console.log(props);\n\n  let citiesBuilt = [];\n  for (let index = 0; index < props.citiesBuilt.length; index++) {\n    citiesBuilt.push(props.citiesBuilt[index].name);\n  }\n\n  return (\n    <Card\n      className={classes.root}\n      style={{margin: '6px 0 6px 1px', backgroundColor: 'rgba(62, 0, 238, 0.6)'}}\n    >\n      <Typography variant=\"subtitle1\">{props.username}</Typography>\n      <Typography variant=\"subtitle1\">\n        {props.character.length !== 0 ? props.character[0].name : '???'}\n      </Typography>\n      <div\n        style={{\n          flex: '0 0 20%',\n          display: 'flex',\n          justifyContent: 'space-around',\n        }}\n      >\n        <Typography>\n          <BiDollarCircle /> {props.coins}\n        </Typography>\n        <Typography>\n          <GiCardBurn /> {props.cardsInHand}\n        </Typography>\n        <Tooltip title={citiesBuilt.length != 0 ? citiesBuilt : ''} placement=\"center\">\n          <Typography>\n            <FaCity /> {props.citiesBuilt.length}\n          </Typography>\n        </Tooltip>\n      </div>\n    </Card>\n  );\n}\n\nexport default PlayerCard;\n","import React, {useState} from 'react';\nimport {Button} from '@material-ui/core';\nimport {IsMyTurn, FindPlayerWithCharacter, GetCurrentSituation} from './Utiliy';\nimport {\n  ChooseCharacterDialog,\n  UseCharacterPowerDialog,\n  TakeActionDialog,\n  BuildDistricDialog,\n  DestroyDistricDialog,\n} from './Dialogs.react';\nimport PlayerCard from './PlayerCard.react';\nimport {Card} from '../bgioComponents/card';\n\nfunction PlayPhaseUI({props}) {\n  const [endStageBtn, setEndStageBtn] = useState(true);\n  const [buildDistrictBtn, setBuildDistrictBtn] = useState(true);\n  const [destroyBtn, setDestroyBtn] = useState(true);\n  const [takeActionBtn, setTakeActionBtn] = useState(false);\n  const [useCharacterBtn, setUseCharacterBtn] = useState(false);\n  let devCharacterNumber = -1;\n\n  // if playphase:\n  //  render use character power which renders dialog depending on power for intput and get payload\n  //  render takeaction btn which shows dialiog to take coin or district and after choosing enable build distric btn and enable end or skip btn and if warlord enable destroy btn\n  //  render build distric btn disabled which shows dialog for building district\n  //  render skip or end stage btn disabled\n  //  if warlord enable destroy btn disabled disolay dialog for warlord.\n  return (\n    <div>\n      <UseCharacterPowerDialog\n        //characterNumber={devCharacterNumber}\n        characterNumber={\n          props.G.players[props.ctx.currentPlayer].chosenCharacter[0].order\n        }\n        murderedCharacter={props.G.murderedCharacter}\n        numPlayers={props.ctx.numPlayers}\n        currentPlayer={props.ctx.currentPlayer}\n        hand={props.G.secret[props.ctx.currentPlayer].hand}\n        useCharacterBtn={useCharacterBtn}\n        setUseCharacterBtn={setUseCharacterBtn}\n        UseCharacterPower={props.moves.UseCharacterPower}\n      ></UseCharacterPowerDialog>\n      <br></br>\n      <TakeActionDialog\n        pileOfCoins={props.G.pileOfCoins}\n        deckOfDistricts={props.G.deckOfDistricts}\n        setEndStageBtn={setEndStageBtn}\n        setBuildDistrictBtn={setBuildDistrictBtn}\n        takeActionBtn={takeActionBtn}\n        setTakeActionBtn={setTakeActionBtn}\n        TakeCoin={props.moves.TakeCoin}\n        TakeDistrictCard={props.moves.TakeDistrictCard}\n      ></TakeActionDialog>\n      <br></br>\n      <BuildDistricDialog\n        props={props}\n        hand={props.G.secret[props.ctx.currentPlayer].hand}\n        coins={props.G.players[props.ctx.currentPlayer].coins}\n        buildDistrictBtn={buildDistrictBtn}\n        setBuildDistrictBtn={setBuildDistrictBtn}\n        BuildDistrict={props.moves.BuildDistrict}\n        setDestroyBtn={setDestroyBtn}\n      ></BuildDistricDialog>\n      <br></br>\n      {props.G.players[props.ctx.currentPlayer].chosenCharacter[0].order === 8 ? (\n        <DestroyDistricDialog\n          hands={props.G.secret}\n          bishopPlayerID={FindPlayerWithCharacter(\n            props.G,\n            props.ctx.numPlayers,\n            5,\n          )}\n          coins={props.G.players[props.ctx.currentPlayer].coins}\n          WarlordPower={props.moves.WarlordPower}\n          EndTurn={props.moves.EndTurn}\n          setEndStageBtn={setEndStageBtn}\n          setBuildDistrictBtn={setBuildDistrictBtn}\n          setTakeActionBtn={setTakeActionBtn}\n          setUseCharacterBtn={setUseCharacterBtn}\n          destroyBtn={destroyBtn}\n          setDestroyBtn={setDestroyBtn}\n        ></DestroyDistricDialog>\n      ) : (\n        <div></div>\n      )}\n      <br></br>\n      <Button\n        variant=\"outlined\"\n        color=\"primary\"\n        onClick={() => {\n          props.moves.SkipOrEndStage();\n          setEndStageBtn(true);\n          setBuildDistrictBtn(true);\n          setTakeActionBtn(false);\n          setUseCharacterBtn(false);\n          setDestroyBtn(false);\n        }}\n        disabled={endStageBtn}\n      >\n        End Turn\n      </Button>\n    </div>\n  );\n}\n\nfunction OtherPlayerTurn({props}) {\n  let situation = GetCurrentSituation(props.G, props.ctx);\n  // returns what is happening.\n  return (\n    <div>\n      <h1>Not your turn yet</h1>\n      <h1>We are on: {situation.phase} phase</h1>\n      <h1>{situation.activePlayer} is playing now</h1>\n    </div>\n  );\n}\n\nfunction Board(props) {\n  let devTurn = \"\";\n  let devPhase = \"\"; //\"playPhase\"\n\n  console.log(props);\n\n  let playerCards = [];\n  for (let index = 0; index < Object.keys(props.G.players).length; index++) {\n    if (props.playerID != index) {\n      playerCards.push(\n        <PlayerCard\n          key={index}\n          username={`Jugador ${index}`}\n          character={\n            props.ctx.currentPlayer == index\n              ? props.G.players[index].chosenCharacter\n              : Array(0)\n          }\n          coins={props.G.players[index].coins}\n          cardsInHand={props.G.players[index].handCount}\n          citiesBuilt={props.G.players[index].builtCity}\n        />,\n      );\n    }\n  }\n\n  let districtsInMyHand = [];\n  for (let index = 0; index < props.G.secret[props.playerID].hand.length; index++) {\n    console.log('Carta ' + index);\n    const image = (\n      <img\n        src={props.G.secret[props.playerID].hand[index].front}\n        alt={props.G.secret[props.playerID].hand[index].name + '-Card-Front'}\n        width=\"100px\"\n        height=\"140px\"\n      />\n    );\n    districtsInMyHand.push(\n      <Card\n        isFaceUp={true}\n        front={image}\n        canHover={true}\n        className=\"highlight\"\n        key={index}\n      />,\n    );\n  }\n\n  let citiesInMyHand = [];\n  for (let index = 0; index < props.G.players[props.playerID].builtCity.length; index++) {\n    console.log('Carta ' + index);\n    const image = (\n      <img\n        src={props.G.players[props.playerID].builtCity[index].front}\n        alt={props.G.players[props.playerID].builtCity[index].name + '-Card-Front'}\n        width=\"100px\"\n        height=\"140px\"\n      />\n    );\n    citiesInMyHand.push(\n      <Card\n        isFaceUp={true}\n        front={image}\n        canHover={true}\n        className=\"highlight\"\n        key={index}\n      />,\n    );\n  }\n\n  if (props.ctx.currentPlayer === props.playerID) {\n    if (props.ctx.phase === 'drawPhase') {\n      return (\n        <div style={{display: 'flex'}}>\n          <div style={{flex: '0 0 20%'}}>{playerCards}</div>\n          {/* TODO: if two players choose two */}\n          <ChooseCharacterDialog\n            deckOfCharacters={props.G.deckOfCharacters}\n            faceDownCharacterCards={props.G.faceDownCharacterCards}\n            faceUpCharacterCards={props.G.faceUpCharacterCards}\n            ChooseCharacter={props.moves.ChooseCharacter}\n          ></ChooseCharacterDialog>\n          <div>\n            <h1>\n              Built Cities\n            </h1>\n            {citiesInMyHand}\n            <h1>\n              Coins\n            </h1>\n            {props.G.players[props.playerID].coins}\n          </div>\n          <div\n            style={{\n              width: '600px',\n              display: 'flex',\n              position: 'fixed',\n              left: '50%',\n              bottom: '50px',\n              transform: 'translateX(-50%)',\n            }}\n          >\n            {districtsInMyHand}\n          </div>\n        </div>\n      );\n    } else if (props.ctx.phase === 'playPhase' || devPhase === 'playPhase') {\n      return (\n        <div style={{display: 'flex'}}>\n          <div style={{flex: '0 0 20%'}}>{playerCards}</div>\n          <PlayPhaseUI props={props} />\n          <div\n            style={{\n              width: '600px',\n              display: 'flex',\n              position: 'fixed',\n              left: '50%',\n              bottom: '50px',\n              transform: 'translateX(-50%)',\n            }}\n          >\n            {districtsInMyHand}\n          </div>\n        </div>\n      );\n    }\n  }\n\n  if (props.ctx.gameover) {\n    console.log(props.ctx.gameover);\n    return <h1>GAME IS OVER WINNERS:...</h1>;\n  }\n\n\n\n  return (\n    <div style={{display: 'flex'}}>\n      <div style={{flex: '0 0 20%'}}>{playerCards}</div>\n      <OtherPlayerTurn props={props}></OtherPlayerTurn>\n      <div\n        style={{\n          width: '600px',\n          display: 'flex',\n          position: 'fixed',\n          left: '50%',\n          bottom: '50px',\n          transform: 'translateX(-50%)',\n        }}\n      >\n        {districtsInMyHand}\n      </div>\n    </div>\n  );\n}\n\nexport default Board;\n","import {Client} from 'boardgame.io/react';\nimport CitadelsGame from 'game/CitadelsGame';\nimport {SocketIO} from 'boardgame.io/multiplayer';\nimport Board from 'components/game/Board.react';\nimport {BGIO_SERVER_URL} from 'game/config/client';\n\nconst GameApp = Client({\n  game: CitadelsGame,\n  board: Board,\n  multiplayer: SocketIO({server: BGIO_SERVER_URL}),\n  debug: true,\n});\n\nexport default GameApp;","import React, {useContext, useState, useEffect, useCallback} from 'react';\nimport {useStoreState} from 'easy-peasy';\nimport {useParams} from 'react-router-dom';\nimport LobbySetup from 'components/lobby/LobbySetup.react';\nimport GameApp from 'components/game/GameApp.react';\n\nfunction LobbyPlay() {\n  const {id} = useParams();\n  const activeRoomPlayer = useStoreState((s) => s.activeRoomPlayer);\n\n  return (\n    <GameApp\n      matchID={id}\n      playerID={String(activeRoomPlayer.playerID)}\n      credentials={activeRoomPlayer.credential}\n    />\n  );\n}\n\nexport default function Lobby() {\n  const [isGameRunning, setGameRunning] = useState(false);\n\n  return isGameRunning ? (\n    <LobbyPlay />\n  ) : (\n    <LobbySetup startGame={() => setGameRunning(true)} />\n  );\n}\n","import app from 'firebase/app';\nimport 'firebase/auth';\nimport 'firebase/database';\nimport 'firebase/firestore';\n\nconst config = {\n  apiKey: process.env.REACT_APP_API_KEY,\n  authDomain: process.env.REACT_APP_AUTH_DOMAIN,\n  databaseURL: process.env.REACT_APP_DATABASE_URL,\n  projectId: process.env.REACT_APP_PROJECT_ID,\n  storageBucket: process.env.REACT_APP_STORAGE_BUCKET,\n  messagingSenderId: process.env.REACT_APP_MESSAGING_SENDER_ID,\n  appId: process.env.REACT_APP_APP_ID,\n  measurementId: process.env.REACT_APP_MEASUREMENT_ID,\n};\n\nclass Firebase {\n  constructor() {\n    app.initializeApp(config);\n\n    this.auth = app.auth();\n    this.facebookProvider = new app.auth.FacebookAuthProvider();\n    this.firestore = app.firestore();\n  }\n\n  createUserWithEmailAndPassword = (email, password) =>\n    this.auth.createUserWithEmailAndPassword(email, password);\n\n  signInWithEmailAndPassword = (email, password) =>\n    this.auth.signInWithEmailAndPassword(email, password);\n\n  signOut = () => this.auth.signOut();\n\n  fetchUserProfile = async () => {\n    const userData = await this.firestore\n      .collection('Users')\n      .doc(this.auth.currentUser.uid)\n      .get();\n    return userData.data();\n  };\n\n  updateProfile = (user) => {\n    return this.firestore\n      .collection('Users')\n      .doc(this.auth.currentUser.uid)\n      .update(user)\n      .catch((error) => console.error('Error: ', error));\n  };\n}\n\nexport const AUTH_ERRORS = {\n  WRONG_PASSWORD: 'auth/wrong-password',\n  USER_NOT_FOUND: 'auth/user-not-found',\n};\n\nexport default Firebase;\n","import React from 'react';\nimport {useContext, useState} from 'react';\nimport FirebaseContext from 'components/firebase/FirebaseContext.react';\nimport {AUTH_ERRORS} from 'utils/Firebase';\nimport {useHistory} from 'react-router-dom';\nimport Typography from '@material-ui/core/Typography';\nimport {makeStyles} from '@material-ui/core/styles';\nimport TextField from '@material-ui/core/TextField';\nimport Button from '@material-ui/core/Button';\nimport OutlinedInput from '@material-ui/core/OutlinedInput';\nimport InputLabel from '@material-ui/core/InputLabel';\nimport InputAdornment from '@material-ui/core/InputAdornment';\nimport Visibility from '@material-ui/icons/Visibility';\nimport VisibilityOff from '@material-ui/icons/VisibilityOff';\nimport FormControl from '@material-ui/core/FormControl';\nimport IconButton from '@material-ui/core/IconButton';\nimport CircularProgress from '@material-ui/core/CircularProgress';\nimport {FontAwesomeIcon} from '@fortawesome/react-fontawesome';\nimport {faFacebookF} from '@fortawesome/free-brands-svg-icons';\nimport validator from 'validator';\nimport FormHelperText from '@material-ui/core/FormHelperText';\nimport * as ROUTES from 'constants/routes';\n\nconst useStyles = makeStyles({\n  root: {\n    width: '100%',\n  },\n  form: {\n    display: 'flex',\n    flexDirection: 'column',\n  },\n  field: {\n    marginTop: 16,\n  },\n  title: {\n    marginBottom: 24,\n  },\n  submit: {\n    marginTop: 16,\n    width: '100%',\n    position: 'relative',\n  },\n  submitProgress: {\n    position: 'absolute',\n    top: '50%',\n    left: '50%',\n    marginTop: -12,\n    marginLeft: -12,\n  },\n  button: {\n    width: '100%',\n    minHeight: 36,\n  },\n  socialContainer: {\n    width: '100%',\n    display: 'flex',\n    justifyContent: 'center',\n  },\n  social: {\n    border: '1px solid #ddd',\n    borderRadius: '50%',\n    display: 'inline-flex',\n    justifyContent: 'center',\n    alignItems: 'center',\n    height: 40,\n    width: 40,\n    cursor: 'pointer',\n  },\n});\n\nfunction SignInForm() {\n  const firebase = useContext(FirebaseContext);\n  const history = useHistory();\n  const [showPassword, setShowPassword] = useState(false);\n  const [fields, setFields] = useState({\n    email: '',\n    password: '',\n  });\n  const [fieldErrors, setFieldErrors] = useState({\n    email: null,\n    password: null,\n  });\n\n  const classes = useStyles();\n  const [loading, setLoading] = useState(false);\n\n  function onFacebookLogin() {\n    firebase.auth\n      .signInWithPopup(firebase.facebookProvider)\n      .then((result) => {\n        // The signed-in user info.\n        const user = result.user;\n\n        return firebase.firestore.collection('Users').doc(user.uid).set({\n          username: user.displayName,\n          email: user.email,\n        });\n      })\n      .then(() => {\n        history.replace(ROUTES.HOME);\n      })\n      .catch(() => {\n        // TODO: Handle errors\n      });\n  }\n\n  function onSubmit(event) {\n    event.preventDefault();\n\n    let errors = {\n      email: null,\n      password: null,\n    };\n\n    if (!validator.isEmail(fields.email)) {\n      errors = {...errors, email: 'Must be a valid email'};\n    }\n\n    if (validator.isEmpty(fields.password)) {\n      errors = {...errors, password: 'Must not be empty'};\n    }\n\n    setFieldErrors(errors);\n\n    const noNullErrors = Object.keys(errors).reduce((acc, current) => {\n      if (errors[current] == null) {\n        return acc;\n      }\n      acc[current] = errors[current];\n      return acc;\n    }, {});\n\n    if (Object.keys(noNullErrors).length !== 0) {\n      return;\n    }\n\n    setLoading(true);\n\n    firebase\n      .signInWithEmailAndPassword(fields.email, fields.password)\n      .then(() => {\n        setLoading(false);\n        history.replace(ROUTES.HOME);\n      })\n      .catch((err) => {\n        console.log(err.code);\n        if (err.code === AUTH_ERRORS.USER_NOT_FOUND) {\n          setFieldErrors({...fieldErrors, email: 'Not found'});\n        } else if (err.code === AUTH_ERRORS.WRONG_PASSWORD) {\n          setFieldErrors({...fieldErrors, password: 'Incorrect password'});\n        }\n        setLoading(false);\n      });\n  }\n\n  return (\n    <div className={classes.root}>\n      <Typography className={classes.title} variant=\"h3\" align=\"center\" gutterBottom>\n        Sign In\n      </Typography>\n      <div className={classes.socialContainer}>\n        <button onClick={onFacebookLogin} className={classes.social}>\n          <FontAwesomeIcon icon={faFacebookF} />\n        </button>\n      </div>\n      <form noValidate className={classes.form} onSubmit={onSubmit} method=\"POST\">\n        <TextField\n          type=\"email\"\n          name=\"email\"\n          className={classes.field}\n          value={fields.email}\n          onChange={(e) => setFields({...fields, email: e.target.value})}\n          label=\"Email\"\n          variant=\"outlined\"\n          error={fieldErrors.email != null}\n          helperText={fieldErrors.email}\n        />\n        <FormControl\n          className={classes.field}\n          variant=\"outlined\"\n          error={fieldErrors.password != null}\n        >\n          <InputLabel htmlFor=\"sign-in-password\">Password</InputLabel>\n          <OutlinedInput\n            id=\"sign-in-password\"\n            name=\"password\"\n            type={showPassword ? 'text' : 'password'}\n            value={fields.password}\n            onChange={(e) => setFields({...fields, password: e.target.value})}\n            endAdornment={\n              <InputAdornment position=\"end\">\n                <IconButton\n                  aria-label=\"toggle password visibility\"\n                  onClick={() => setShowPassword(!showPassword)}\n                  edge=\"end\"\n                >\n                  {showPassword ? <Visibility /> : <VisibilityOff />}\n                </IconButton>\n              </InputAdornment>\n            }\n            labelWidth={70}\n          />\n          {fieldErrors.password != null ? (\n            <FormHelperText>{fieldErrors.password}</FormHelperText>\n          ) : null}\n        </FormControl>\n        <div className={classes.submit}>\n          <Button\n            className={classes.button}\n            type=\"submit\"\n            variant=\"contained\"\n            color=\"primary\"\n            disabled={loading}\n            id=\"sign-in-button\"\n          >\n            {!loading && 'Sign In'}\n          </Button>\n          {loading && <CircularProgress size={24} className={classes.submitProgress} />}\n        </div>\n      </form>\n    </div>\n  );\n}\n\nexport default SignInForm;\n","export const AUTHENTICATION = '/auth';\nexport const LOBBY = '/rooms/:id';\nexport const HOME = '/';\n","import React from 'react';\nimport {useContext, useState} from 'react';\nimport FirebaseContext from 'components/firebase/FirebaseContext.react';\nimport {useHistory} from 'react-router-dom';\nimport Typography from '@material-ui/core/Typography';\nimport {makeStyles} from '@material-ui/core/styles';\nimport TextField from '@material-ui/core/TextField';\nimport Button from '@material-ui/core/Button';\nimport OutlinedInput from '@material-ui/core/OutlinedInput';\nimport InputLabel from '@material-ui/core/InputLabel';\nimport InputAdornment from '@material-ui/core/InputAdornment';\nimport Visibility from '@material-ui/icons/Visibility';\nimport VisibilityOff from '@material-ui/icons/VisibilityOff';\nimport FormControl from '@material-ui/core/FormControl';\nimport IconButton from '@material-ui/core/IconButton';\nimport CircularProgress from '@material-ui/core/CircularProgress';\nimport * as ROUTES from 'constants/routes';\nimport validator from 'validator';\nimport FormHelperText from '@material-ui/core/FormHelperText';\n\nconst useStyles = makeStyles({\n  root: {\n    width: '100%',\n  },\n  form: {\n    display: 'flex',\n    flexDirection: 'column',\n  },\n  field: {\n    marginTop: 16,\n  },\n  title: {\n    marginBottom: 24,\n  },\n  submit: {\n    marginTop: 16,\n    width: '100%',\n    position: 'relative',\n  },\n  submitProgress: {\n    position: 'absolute',\n    top: '50%',\n    left: '50%',\n    marginTop: -12,\n    marginLeft: -12,\n  },\n  button: {\n    width: '100%',\n    minHeight: 36,\n  },\n});\n\nfunction SignUpForm() {\n  const firebase = useContext(FirebaseContext);\n  const history = useHistory();\n  const [showPassword, setShowPassword] = useState(false);\n  const [showConfirmationPassword, setShowConfirmationPassword] = useState(false);\n  const [fields, setFields] = useState({\n    username: '',\n    email: '',\n    password: '',\n    confirmationPassword: '',\n  });\n  const [fieldErrors, setFieldErrors] = useState({\n    username: null,\n    email: null,\n    password: null,\n    confirmationPassword: null,\n  });\n  const classes = useStyles();\n  const [loading, setLoading] = useState(false);\n\n  function onSubmit(event) {\n    event.preventDefault();\n\n    let errors = {\n      username: null,\n      email: null,\n      password: null,\n      confirmationPassword: null,\n    };\n\n    if (validator.isEmpty(fields.username)) {\n      errors = {...errors, username: 'Must not be empty'};\n    }\n\n    if (!validator.isEmail(fields.email)) {\n      errors = {...errors, email: 'Must be a valid email'};\n    }\n\n    if (!validator.isLength(fields.password, {min: 6})) {\n      errors = {...errors, password: 'Must be at least six characters long'};\n    }\n\n    if (\n      errors.password == null &&\n      !validator.equals(fields.password, fields.confirmationPassword)\n    ) {\n      errors = {...errors, confirmationPassword: 'Passwords must be equal'};\n    }\n\n    setFieldErrors(errors);\n\n    const noNullErrors = Object.keys(errors).reduce((acc, current) => {\n      if (errors[current] == null) {\n        return acc;\n      }\n      acc[current] = errors[current];\n      return acc;\n    }, {});\n\n    if (Object.keys(noNullErrors).length !== 0) {\n      return;\n    }\n\n    setLoading(true);\n\n    firebase\n      .createUserWithEmailAndPassword(fields.email, fields.password)\n      .then((result) =>\n        firebase.firestore.collection('Users').doc(result.user.uid).set({\n          username: fields.username,\n          email: fields.email,\n        }),\n      )\n      .then(() => {\n        setLoading(false);\n        history.replace(ROUTES.HOME);\n      })\n      .catch(() => {\n        setLoading(false);\n      });\n  }\n\n  return (\n    <div className={classes.root}>\n      <Typography className={classes.title} variant=\"h3\" align=\"center\" gutterBottom>\n        Sign Up\n      </Typography>\n      <form className={classes.form} onSubmit={onSubmit} noValidate method=\"POST\">\n        <TextField\n          name=\"username\"\n          className={classes.field}\n          value={fields.username}\n          onChange={(e) => setFields({...fields, username: e.target.value})}\n          label=\"Username\"\n          variant=\"outlined\"\n          error={fieldErrors.username != null}\n          helperText={fieldErrors.username}\n        />\n        <TextField\n          type=\"email\"\n          name=\"email\"\n          className={classes.field}\n          value={fields.email}\n          onChange={(e) => setFields({...fields, email: e.target.value})}\n          label=\"Email\"\n          variant=\"outlined\"\n          error={fieldErrors.email != null}\n          helperText={fieldErrors.email}\n        />\n        <FormControl\n          className={classes.field}\n          variant=\"outlined\"\n          error={fieldErrors.password != null}\n        >\n          <InputLabel htmlFor=\"sign-up-password\">Password</InputLabel>\n          <OutlinedInput\n            id=\"sign-up-password\"\n            name=\"password\"\n            type={showPassword ? 'text' : 'password'}\n            value={fields.password}\n            onChange={(e) => setFields({...fields, password: e.target.value})}\n            endAdornment={\n              <InputAdornment position=\"end\">\n                <IconButton\n                  aria-label=\"toggle password visibility\"\n                  onClick={() => setShowPassword(!showPassword)}\n                  edge=\"end\"\n                >\n                  {showPassword ? <Visibility /> : <VisibilityOff />}\n                </IconButton>\n              </InputAdornment>\n            }\n            labelWidth={70}\n          />\n          {fieldErrors.password != null ? (\n            <FormHelperText>{fieldErrors.password}</FormHelperText>\n          ) : null}\n        </FormControl>\n        <FormControl\n          className={classes.field}\n          variant=\"outlined\"\n          error={fieldErrors.confirmationPassword != null}\n        >\n          <InputLabel htmlFor=\"sign-up-confirmation-password\">\n            Confirm Password\n          </InputLabel>\n          <OutlinedInput\n            id=\"sign-up-confirmation-password\"\n            name=\"confirmationPassword\"\n            type={showConfirmationPassword ? 'text' : 'password'}\n            value={fields.confirmationPassword}\n            onChange={(e) =>\n              setFields({...fields, confirmationPassword: e.target.value})\n            }\n            endAdornment={\n              <InputAdornment position=\"end\">\n                <IconButton\n                  aria-label=\"toggle password visibility\"\n                  onClick={() => setShowConfirmationPassword(!showConfirmationPassword)}\n                  edge=\"end\"\n                >\n                  {showConfirmationPassword ? <Visibility /> : <VisibilityOff />}\n                </IconButton>\n              </InputAdornment>\n            }\n            labelWidth={135}\n          />\n          {fieldErrors.confirmationPassword != null ? (\n            <FormHelperText>{fieldErrors.confirmationPassword}</FormHelperText>\n          ) : null}\n        </FormControl>\n        <div className={classes.submit}>\n          <Button\n            className={classes.button}\n            type=\"submit\"\n            variant=\"contained\"\n            color=\"primary\"\n            disabled={loading}\n          >\n            {!loading && 'Sign Up'}\n          </Button>\n          {loading && <CircularProgress size={24} className={classes.submitProgress} />}\n        </div>\n      </form>\n    </div>\n  );\n}\n\nexport default SignUpForm;\n","import React from 'react';\nimport {makeStyles} from '@material-ui/core/styles';\nimport Paper from '@material-ui/core/Paper';\nimport clsx from 'clsx';\nimport SignInForm from 'components/authentication/SignInForm.react';\nimport SignUpForm from 'components/authentication/SignUpForm.react';\n\nconst useStyles = makeStyles({\n  root: {\n    background: '#6A62D2',\n    height: '100vh',\n    display: 'flex',\n    justifyContent: 'center',\n    alignItems: 'center',\n  },\n  card: {\n    minWidth: 768,\n    display: 'flex',\n  },\n  panel: {\n    flex: 1,\n    padding: 24,\n  },\n  rightPanel: {\n    background: '#C0E5C8',\n  },\n});\n\nfunction Authentication() {\n  const classes = useStyles();\n  return (\n    <main className={classes.root}>\n      <Paper className={classes.card}>\n        <div className={classes.panel}>\n          <SignInForm />\n        </div>\n        <div className={clsx(classes.panel, classes.rightPanel)}>\n          <SignUpForm />\n        </div>\n      </Paper>\n    </main>\n  );\n}\n\nexport default Authentication;\n","import React from 'react';\nimport FirebaseContext from 'components/firebase/FirebaseContext.react';\nimport {useContext, useState, useEffect} from 'react';\nimport {Redirect} from 'react-router-dom';\n\nimport * as ROUTES from 'constants/routes';\n\nfunction AuthRenderer({children, fallback}) {\n  const firebase = useContext(FirebaseContext);\n  // Initial state\n  const [state, setState] = useState({loading: true, authenticated: false});\n\n  useEffect(() => {\n    const listener = firebase.auth.onAuthStateChanged((logged) => {\n      if (logged === null) {\n        setState({loading: false, authenticated: false});\n        return;\n      }\n      setState({loading: false, authenticated: true});\n    });\n    return function () {\n      // Cleanup\n      listener();\n    };\n  }, [setState, firebase]);\n\n  if (state.loading) {\n    return fallback;\n  }\n\n  if (!state.loading && !state.authenticated) {\n    return <Redirect to={ROUTES.AUTHENTICATION} />;\n  }\n\n  return children;\n}\n\nexport default AuthRenderer;\n","import React from 'react';\nimport FirebaseContext from 'components/firebase/FirebaseContext.react';\nimport {useContext, useState, useEffect} from 'react';\nimport {Redirect} from 'react-router-dom';\n\nimport * as ROUTES from 'constants/routes';\n\n// Renders the children when there is not a session, the opposite of AuthRenderer\nfunction NoAuthRenderer({children, fallback}) {\n  const firebase = useContext(FirebaseContext);\n  // Initial state\n  const [state, setState] = useState({loading: true, authenticated: false});\n\n  useEffect(() => {\n    const listener = firebase.auth.onAuthStateChanged((logged) => {\n      if (logged === null) {\n        setState({loading: false, authenticated: false});\n        return;\n      }\n      setState({loading: false, authenticated: true});\n    });\n    return function () {\n      // Cleanup\n      listener();\n    };\n  }, [setState, firebase]);\n\n  if (state.loading) {\n    return fallback;\n  }\n\n  if (!state.loading && !state.authenticated) {\n    return children;\n  }\n\n  return <Redirect to={ROUTES.HOME} />;\n}\n\nexport default NoAuthRenderer;\n","import React from 'react';\nimport {BrowserRouter as Router, Route, Switch} from 'react-router-dom';\nimport Home from 'components/home/Home.react';\nimport Lobby from 'components/lobby/Lobby.react';\nimport Authentication from 'components/authentication/Authentication.react';\nimport AuthRenderer from 'components/shared/AuthRenderer.react';\nimport NoAuthRenderer from 'components/shared/NoAuthRenderer.react';\nimport * as ROUTES from 'constants/routes';\n\nconst App = () => (\n  <Router>\n    <Switch>\n      <Route exact path={ROUTES.HOME}>\n        <AuthRenderer fallback={<p>Loading...</p>}>\n          <Home />\n        </AuthRenderer>\n      </Route>\n      <Route exact path={ROUTES.AUTHENTICATION}>\n        <NoAuthRenderer fallback={<p>Loading...</p>}>\n          <Authentication />\n        </NoAuthRenderer>\n      </Route>\n      <Route exact path={ROUTES.LOBBY}>\n        <AuthRenderer fallback={<p>Loading...</p>}>\n          <Lobby />\n        </AuthRenderer>\n      </Route>\n    </Switch>\n  </Router>\n);\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport 'typeface-nunito';\nimport 'index.css';\nimport {StoreProvider} from 'easy-peasy';\nimport {initializeStore} from 'store';\nimport {PLAYER_STORAGE_KEY} from 'store/store';\nimport App from 'App.react';\nimport GameApp from 'components/game/GameApp.react';\nimport FirebaseContext from 'components/firebase/FirebaseContext.react';\nimport Firebase from 'utils/Firebase';\n// Import the wrapper component, and the the creator function\nimport {MuiThemeProvider, createMuiTheme} from '@material-ui/core/styles';\n\n// Create a new theme using Nunito\nconst theme = createMuiTheme({\n  typography: {\n    fontFamily: 'Nunito, Roboto, sans-serif',\n  },\n});\n\nconst savedPlayer = localStorage.getItem(PLAYER_STORAGE_KEY);\n\nconst store = initializeStore({\n  activeRoomPlayer: savedPlayer ? JSON.parse(savedPlayer) : null,\n});\n\nReactDOM.render(\n  <StoreProvider store={store}>\n    <FirebaseContext.Provider value={new Firebase()}>\n      {/* <SocketContext.Provider value={new SocketIOClient()}> */}\n      <MuiThemeProvider theme={theme}>\n        <App />\n        {/* <GameApp /> */}\n      </MuiThemeProvider>\n      {/* </SocketContext.Provider> */}\n    </FirebaseContext.Provider>\n  </StoreProvider>,\n  document.getElementById('root'),\n);\n","import {createStore} from 'easy-peasy';\nimport {setInitState, store} from 'store/store';\nimport LobbyService from 'services/LobbyService';\n\n// export interface StoreInjections {\n//   lobbyApi: LobbyService;\n// }\n\nexport const initializeStore = (initialState) => {\n  setInitState(initialState);\n  return createStore(store, {\n    initialState,\n    injections: {lobbyApi: new LobbyService()},\n  });\n};\n"],"sourceRoot":""}